if (self.CavalryLogger) { CavalryLogger.start_js(["v8VH1"]); }

__d("BrowseFacebarHighlighter",["csx","CSS","NodeHighlighter"],(function(a,b,c,d,e,f,g){"use strict";a={};Object.assign(a,b("NodeHighlighter"),{getHighlightCandidates:function(){return["._53ad"]},isDiscardNode:function(a){return b("CSS").hasClass(a,"DefaultText")},createSegmentedRegex:function(a){a=this.escapeAndAddBidirectionalCharsToTokens(a);return"(^|\\s|\\b)("+a.join("|")+")"}});e.exports=a}),null);
__d("FacebarResultStoreUtils",["FacebarGlobalOptions","FacebarJSConstants"],(function(a,b,c,d,e,f){"use strict";a={getQueryFeatures:function(a){var c={};if(b("FacebarGlobalOptions").enableBootstrapRanking){a.raw_text&&(c.FEATURE_QUERY_LENGTH=a.raw_text.length);if(a.tokens){c.FEATURE_QUERY_TOKENS=a.tokens.length;c.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var d=0;d<a.tokens.length;d++)c.FEATURE_QUERY_TOKEN_LENGTH_SUM+=a.tokens[d].length}}return c},addFeatures:function(a,b,c,d,e,f){if(!a.features)return;a.features={FEATURE_QUERY_LENGTH:d.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:d.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:d.FEATURE_QUERY_TOKEN_LENGTH_SUM};a.features.FEATURE_IS_EXACT_NAME_MATCH=e;a.features.FEATURE_IS_STOP_WORD_MATCH=f;if(b&&b.length>0){d=b.split(" ").length;e=0;for(var f=0;f<a.termMatches.length;++f)b.search(a.termMatches[f])>=0&&e++;a.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=e/d}if(c.tokens&&c.tokens.length>0){f=b.search(c.tokens[0]);a.features.FEATURE_FIRST_TERM_MATCH_POSITION=f;a.features.FEATURE_FIRST_TERM_MATCH_TOKEN=b.substring(0,f+c.tokens[0].length).split(" ").length;a.termMatches.some(function(b){if(b.search(c.tokens[0])===0){a.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=c.tokens[0].length/b.length;return!0}return!1});a.features.FEATURE_IN_ORDER_MATCH=1;c.tokens.length>1&&(f=b.search(c.tokens[1]),a.features.FEATURE_SECOND_TERM_MATCH_POSITION=f,a.features.FEATURE_SECOND_TERM_MATCH_TOKEN=b.substring(0,f+c.tokens[1].length).split(" ").length,a.termMatches.some(function(b){if(b.search(c.tokens[1])===0){a.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=c.tokens[0].length/b.length;return!0}return!1}),a.features.FEATURE_SECOND_TERM_MATCH_TOKEN<a.features.FEATURE_FIRST_TERM_MATCH_POSITION&&(a.features.FEATURE_IN_ORDER_MATCH=0))}return a},processEntityResult:function(a,c,d,e,f,g,h,i,j){a={semantic:c.toString(),structure:[{type:a===b("FacebarJSConstants").keywordType?a:"ent:"+a,text:d,uid:c}],type:a,cost:e,cache_id_length:0,features:[]};a.tuid=JSON.stringify({semantic:a.semantic,structure:a.structure});b("FacebarGlobalOptions").enableBootstrapRanking&&(a.termMatches=h[c.toString()],a=this.addFeatures(a,d.toLowerCase(),f,g,i,j));return a},getRawTextFromStructured:function(a){a=a.map(function(a){return a.getText()});return a.join("")},getTextFromResult:function(a){a=a.structure;var b="";a.forEach(function(a){b+=a.text});return b}};e.exports=a}),null);
__d("HashtagParser",["URLMatcher","getHashtagRegex"],(function(a,b,c,d,e,f){var g=100,h=30,i=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function a(a){var b=u(a),c=0,d=0;return j(a).map(function(a){while(c<b.length){var e=b[c],f=e.offset-d;if(f<a.offset)d+=e.token.length-e.name.length,c++;else break}return{marker:a.marker,tag:a.hashtag,rawOffset:a.offset+d,offset:a.offset}})}function c(a){return k(a,p(a))}function j(a){var b=w(a);return k(b,l(a,b))}function k(a,b){return n(a).slice(0,h).filter(function(a){var c=r(a.offset,a.hashtag.length,b);return!c&&a.hashtag.length<=g})}function l(a,b){return q(o(a),p(b))}var m=b("getHashtagRegex")();function n(a){var b=[];a.replace(m,function(a,c,d,e,f){b.push({marker:d,hashtag:e,offset:f+c.length})});return b}function o(a){return x(a).map(function(a){return[a.offset,a.name.length]})}function p(a){var c=[],d,e=0;while(d=b("URLMatcher").permissiveMatch(a)){var f=a.indexOf(d);c.push([e+f,d.length]);a=a.substring(f+d.length);e+=f+d.length}return c}function q(a,b){var c=[],d=0,e=0,f=0;while(d<a.length&&e<b.length)a[d][0]>b[e][0]?c[f++]=b[e++]:c[f++]=a[d++];return c.concat(a.slice(d),b.slice(e))}function r(a,b,c){if(!c)return!1;var d=t(c,a);return s(a,b,c,d)||s(a,b,c,d+1)}function s(a,b,c,d){if(!c[d])return!1;var e=c[d][0];c=c[d][1];return!(a+b-1<e||a>e+c-1)}function t(a,b){var c=0,d=a.length-1;while(c<=d){var e=Math.floor((c+d)/2),f=a[e][0];if(f==b)return e;else f<b?c=e+1:d=e-1}return d}function u(a){var b=[];a.replace(i,function(a,c,d,e,f){b.push({token:a,id:c,type:d,name:e,offset:f})});return b}function v(a){return a?a.replace(/\\([^\\])/g,"$1").replace(/\\\\/g,"\\"):null}function w(a){return a.replace(i,function(a,b,c,d,e){return v(d)})}function x(a){var b=0,c=0;return u(a).map(function(d){var e=a.indexOf(d.token,c);c=e+1;e-=b;var f=v(d.name);b+=d.token.length-f.length;if(e>=0)return{id:d.id,name:f,type:d.type,offset:e}})}d={};d.parse=a;d.parseWithoutMentions=c;e.exports=d}),null);
__d("HashtagSearchResultUtils",["fbt","FacebarResultStoreUtils","HashtagParser","HashtagSearchResultConfig","URI"],(function(a,b,c,d,e,f,g){var h;a={getHashtagFromQuery:function(a){a=b("HashtagParser").parse(a);return a&&a.length===1&&a[0].offset===0?a[0].tag:!1},makeTypeaheadResult:function(a){var c=g._("Hashtag");return{category:c,path:new(h||(h=b("URI")))("/hashtag/"+a).toString(),photo:b("HashtagSearchResultConfig").image_url,rankType:null,replace_results:b("HashtagSearchResultConfig").boost_result?!0:!1,scaled_score:1,score:0,text:"#"+a,type:"hashtag_exact",uid:"hashtag:"+a}},makeFacebarEntry:function(a){var c=g._("Hashtag");return{category:c,path:new(h||(h=b("URI")))("/hashtag/"+a).toString(),photo:b("HashtagSearchResultConfig").image_url,replace_results:b("HashtagSearchResultConfig").boost_result?!0:!1,text:"#"+a,type:"hashtag_exact",uid:"hashtag:"+a}},makeFacebarResult:function(a){var c=b("FacebarResultStoreUtils").processEntityResult("hashtag_exact","hashtag:"+a,"#"+a,b("HashtagSearchResultConfig").hashtag_cost);c.parse={display:[{type:"ent:hashtag_exact",uid:"hashtag:"+a}],remTokens:[],suffix:""};c.tags={hashtag:"hashtag"};return c}};e.exports=a}),null);
__d("Typeahead",["ArbiterMixin","BehaviorsMixin","DataStore","DOM","Event","Parent","Run","Style","emptyFunction","ge","mixin"],(function(a,b,c,d,e,f){c=function(c){"use strict";babelHelpers.inheritsLoose(d,c);function d(a,d,e,f){var g;g=c.call(this)||this;g.args={data:a,view:d,core:e};b("DataStore").set(f,"Typeahead",babelHelpers.assertThisInitialized(g));g.element=f;return g}var e=d.prototype;e.init=function(a){this.init=b("emptyFunction"),this.getCore(),this.getView().setAccessibilityControlElement(this.getCore().getElement()),this.proxyEvents(),this.initBehaviors(a||[]),this.inform("init",this),this.data.bootstrap(),this.core.focus()};e.getData=function(){if(!this.data){var a=this.args.data;this.data=a;this.data.init()}return this.data};e.getView=function(){if(!this.view){var a=this.args.view,c=a.node||b("ge")(a.node_id);c||(c=b("DOM").create("div",{className:"uiTypeaheadView"}),b("DOM").appendContent(this.element,c));typeof a.ctor==="string"?this.view=new window[a.ctor](c,a.options||{}):this.view=new a.ctor(c,a.options||{});this.view.init();this.view.setTypeahead(this.element)}return this.view};e.getCore=function(){if(!this.core){var a=this.args.core;typeof a.ctor==="string"?this.core=new window[a.ctor](a.options||{}):this.core=new a.ctor(a.options||{});this.core.init(this.getData(),this.getView(),this.getElement())}return this.core};e.getElement=function(){return this.element};e.setHeight=function(a){a!=="auto"&&(a+="px"),b("Style").set(this.element,"height",a)};e.swapData=function(a){return this.$Typeahead1(a,!0)};e.swapDataNoCoreReset=function(a){return this.$Typeahead1(a,!1)};e.$Typeahead1=function(a,b){var c=this.core;this.data=this.args.data=a;a.init();c&&(c.data=a,c.initData(),b&&c.reset(),this.proxyEvents());a.bootstrap();return a};e.proxyEvents=function(){[this.data,this.view,this.core].forEach(function(a){a.subscribe(a.events,this.inform.bind(this))},this)};e.initBehaviors=function(c){c.forEach(function(c){typeof c==="string"?a.TypeaheadBehaviors&&a.TypeaheadBehaviors[c]?a.TypeaheadBehaviors[c](this):b("Run").onLoad(function(){a.TypeaheadBehaviors&&(a.TypeaheadBehaviors[c]||b("emptyFunction"))(this)}.bind(this)):this.enableBehavior(c)},this)};d.getInstance=function(a){a=b("Parent").byClass(a,"uiTypeahead");return a?b("DataStore").get(a,"Typeahead"):null};d.initNow=function(a,b,c){c&&c.init(a),a.init(b)};d.init=function(a,c,e,f){b("DOM").isNodeOfType(a,["input","textarea"])||(a=b("DOM").scry(a,"input")[0]||b("DOM").scry(a,"textarea")[0]);var g=!1;try{g=document.activeElement===a}catch(a){}if(g)d.initNow(c,e,f);else var h=b("Event").listen(a,"focus",function(){d.initNow(c,e,f),h.remove()})};return d}(b("mixin")(b("ArbiterMixin"),b("BehaviorsMixin")));e.exports=c}),null);
__d("BasicTypeaheadRenderer",["BadgeHelper","DOM"],(function(a,b,c,d,e,f){function a(a,c){c=[];a.icon&&c.push(b("DOM").create("img",{alt:"",src:a.icon}));var d=a.debug_info;d&&c.push(b("DOM").create("span",{className:"debugInfo"},d));if(a.text){d=[a.text];a.is_verified&&d.push(b("BadgeHelper").renderBadge("xsmall","verified"));c.push(b("DOM").create("span",{className:"text"},d))}if(a.subtext){d=[a.subtext];c.push(b("DOM").create("span",{className:"subtext"},d))}d=b("DOM").create("li",{className:a.type||""},c);a.text&&(d.setAttribute("title",a.text),d.setAttribute("aria-label",a.text));return d}a.className="basic";e.exports=a}),null);
__d("createIxElement",["invariant","DOM","joinClasses"],(function(a,b,c,d,e,f,g){function a(a,c){var d="img";a.sprited||a.uri||g(0,2521);if(a.sprited){d=b("joinClasses")(d,a.spriteMapCssClass,a.spriteCssClass);var e=b("DOM").create("i",{className:d});c!=null&&b("DOM").setContent(e,b("DOM").create("u",null,c));return e}e=b("DOM").create("img",{className:d,src:a.uri});c!=null&&e.setAttribute("alt",c);a.width&&e.setAttribute("width",String(a.width));a.height&&e.setAttribute("height",String(a.height));return e}e.exports=a}),null);
__d("TypeaheadView",["csx","cx","ix","ArbiterMixin","BasicTypeaheadRenderer","CSS","DOM","Event","Parent","$","createIxElement","getElementText","getOrCreateDOMID","mixin"],(function(a,b,c,d,e,f,g,h,i){c=function(c){"use strict";babelHelpers.inheritsLoose(d,c);function d(a,d){var e;e=c.call(this)||this;e.initialized=!1;e.$TypeaheadView1=0;e.element=e.content=b("$").fromIDOrElement(a);Object.assign(babelHelpers.assertThisInitialized(e),d);return e}var e=d.prototype;e.init=function(){this.initialized||(this.initialized=!0,this.initializeEvents(),this.reset())};e.initializeEvents=function(){b("Event").listen(this.element,{mouseup:this.mouseup.bind(this),mouseover:this.mouseover.bind(this)})};e.setTypeahead=function(a){this.typeahead=a};e.setAccessibilityControlElement=function(a){this.accessibilityElement=a};e.getElement=function(){return this.element};e.mouseup=function(a){a.button!=2&&(this.select(!0),a.prevent())};e.mouseover=function(a){if(this.ignoreMouseover){this.ignoreMouseover=!1;return}this.visible&&(this.resetColumn(),this.highlight(this.getIndex(a)))};e.reset=function(a){a||(this.disableAutoSelect=!1);this.index=-1;this.$TypeaheadView1=0;this.$TypeaheadView2();this.items=[];this.results=[];this.value="";this.content.innerHTML="";this.inform("reset");return this};e.getIndex=function(a){return this.items.indexOf(b("Parent").byTag(a.getTarget(),"li"))};e.getSelection=function(){var a=this.results[this.index]||null;return this.visible?a:null};e.isEmpty=function(){return!this.results.length};e.isVisible=function(){return!!this.visible};e.show=function(){b("CSS").show(this.element);if(this.results&&this.results.length&&(this.autoSelect&&this.accessibilityElement&&this.selected)){var a=b("DOM").scry(this.selected,'[role="gridcell"]');a=a.length<2?this.selected:a[this.$TypeaheadView1];this.accessibilityElement.setAttribute("aria-activedescendant",b("getOrCreateDOMID")(a))}this.accessibilityElement&&this.accessibilityElement.setAttribute("aria-expanded","true");this.visible=!0;return this};e.hide=function(){b("CSS").hide(this.element);this.accessibilityElement&&(this.accessibilityElement.setAttribute("aria-expanded","false"),this.accessibilityElement.removeAttribute("aria-activedescendant"));this.visible=!1;return this};e.render=function(a,c,d){this.value=a;if(!c.length){this.accessibilityElement&&this.accessibilityElement.removeAttribute("aria-activedescendant");this.reset(!0);return}a={results:c,value:a};this.inform("beforeRender",a);c=a.results;a=(!this.value||d)&&this.index!==-1?this.index:this.getDefaultIndex(c);this.results=c;b("DOM").setContent(this.content,this.buildResults(c));this.items=this.getItems();this.highlight(a,!1);this.inform("render",this.results)};e.getItems=function(){return b("DOM").scry(this.content,"li")};e.buildResults=function(c){var d,e=null;typeof this.renderer==="function"?(d=this.renderer,e=this.renderer.className||""):(d=a.TypeaheadRenderers[this.renderer],e=this.renderer);d=d.bind(this);c=c.map(function(a,b){a=a.node||d(a,b);a.setAttribute("role","option");return a});e=b("DOM").create("ul",{className:e,id:"typeahead_list_"+(this.typeahead?b("getOrCreateDOMID")(this.typeahead):b("getOrCreateDOMID")(this.element))},c);e.setAttribute("role","listbox");return e};e.showLoadingIndicator=function(){var a=b("createIxElement")(i("85428"));a=b("DOM").create("li",{className:"typeaheadViewInternalLoading"},a);a=b("DOM").create("ul",{role:"listbox"},a);b("DOM").setContent(this.content,a)};e.getDefaultIndex=function(a){a=this.autoSelect&&!this.disableAutoSelect;return this.index<0&&!a?-1:0};e.$TypeaheadView2=function(){var a=b("DOM").scry(this.element,".active")[0];a!=null&&b("CSS").removeClass(a,"active");if(this.selected==null||this.index===-1)return;a=b("DOM").scry(this.selected,'[role="gridcell"]');if(a.length<2)return;a=a[this.$TypeaheadView1];b("CSS").addClass(a,"active")};e.next=function(){this.$TypeaheadView1=0,this.highlight(this.index+1),this.inform("next",this.selected)};e.prev=function(){this.$TypeaheadView1=0,this.highlight(this.index-1),this.inform("prev",this.selected)};e.getCurrentColumnIndex=function(){return this.$TypeaheadView1};e.resetColumn=function(){if(this.selected==null)return;var a=b("DOM").scry(this.selected,'[role="gridcell"]');if(a.length<2)return;this.$TypeaheadView1=0;a=a[this.$TypeaheadView1];this.accessibilityElement.setAttribute("aria-activedescendant",b("getOrCreateDOMID")(a));this.$TypeaheadView2()};e.nextColumn=function(){if(this.index==-1||this.selected==null)return;var a=b("DOM").scry(this.selected,'[role="gridcell"]');if(a.length<2)return;if(this.$TypeaheadView1<a.length-1){this.$TypeaheadView1++;a=a[this.$TypeaheadView1];this.accessibilityElement.setAttribute("aria-activedescendant",b("getOrCreateDOMID")(a));this.$TypeaheadView2()}else this.next()};e.prevColumn=function(){if(this.index==-1||this.selected==null)return;var a=b("DOM").scry(this.selected,'[role="gridcell"]');if(a.length<2)return;if(this.$TypeaheadView1>0){this.$TypeaheadView1--;a=a[this.$TypeaheadView1];this.accessibilityElement.setAttribute("aria-activedescendant",b("getOrCreateDOMID")(a));this.$TypeaheadView2()}else this.prev()};e.getItemText=function(a){var c="";a&&(c=a.getAttribute("aria-label"),c||(c=b("getElementText")(a),a.setAttribute("aria-label",c)));return c};e.setIsViewingSelectedItems=function(a){this.viewingSelected=a;return this};e.getIsViewingSelectedItems=function(){return!!this.viewingSelected};e.highlight=function(a,c){var d=this,e=this.selected;e!=null&&(b("CSS").removeClass(e,"selected"),e.setAttribute("aria-selected","false"));a>this.items.length-1?a=-1:a<-1&&(a=this.items.length-1);a>=0&&a<this.items.length?(this.selected=this.items[a],b("CSS").addClass(this.selected,"selected"),this.selected!=null&&this.selected.setAttribute("aria-selected","true"),this.accessibilityElement&&window.setTimeout(function(){var a=b("DOM").scry(d.selected,'[role="gridcell"]');a=a.length<2?d.selected:a[d.$TypeaheadView1];a!=null&&d.accessibilityElement.setAttribute("aria-activedescendant",b("getOrCreateDOMID")(a));d.$TypeaheadView2()},0)):this.accessibilityElement&&this.accessibilityElement.removeAttribute("aria-activedescendant");this.index=a;this.disableAutoSelect=a==-1;c!==!1&&this.inform("highlight",{index:a,selected:this.results[a],element:this.selected})};e.select=function(a){if(this.headerIndex&&a)return;var b=this.index,c=this.results[b],d=this.element.getAttribute("id");if(c){var e=function(c){this.inform("select",{index:b,clicked:!!a,selected:c,id:d,query:this.value,element:this.selected}),this.inform("afterSelect")}.bind(this);this.shouldValidateTypeaheadSelection(c)?this.validateTypeaheadSelection(c,e):e(c)}};e.shouldValidateTypeaheadSelection=function(a){return!1};e.validateTypeaheadSelection=function(a,b){};return d}(b("mixin")(b("ArbiterMixin")));Object.assign(c.prototype,{events:["highlight","render","reset","select","beforeRender","next","prev"],renderer:b("BasicTypeaheadRenderer"),autoSelect:!1,ignoreMouseover:!1});e.exports=c}),null);
__d("WIGBackgroundImage.react",["CometBackgroundImage.react","React"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){return g.jsx(b("CometBackgroundImage.react"),babelHelpers["extends"]({},a))}e.exports=a}),null);
__d("SimpleStructuredInput",["csx","ArbiterMixin","DataStore","DOM","Event","FacebarStructuredText","FlipDirection","Input","Parent","getActiveElement","mixin","requestAnimationFrame"],(function(a,b,c,d,e,f,g){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$SimpleStructuredInput1=c;d.$SimpleStructuredInput2=b("DOM").find(c,"._1frb");d.$SimpleStructuredInput3=b("DOM").find(c,"._5eay");b("DataStore").set(c,"SimpleStructuredInput",babelHelpers.assertThisInitialized(d));d.init();return d}var d=c.prototype;d.init=function(){var a=this,c=function(b){return a.inform(b.type)};b("Event").listen(this.$SimpleStructuredInput2,"blur",c);b("Event").listen(this.$SimpleStructuredInput2,"focus",c);b("Event").listen(this.$SimpleStructuredInput2,"input",function(){b("FlipDirection").setDirection(a.$SimpleStructuredInput2,1,!0),a.inform("change"),b("requestAnimationFrame")(function(){a.$SimpleStructuredInput2.scrollLeft>0&&a.clearHint()})});this.inform("init",null,"persistent")};d.clearHint=function(){b("Input").setValue(this.$SimpleStructuredInput3,"")};d.setHint=function(a){a=a.map(function(a){return a.text}).join("");var c=b("Input").getValue(this.$SimpleStructuredInput2);this.hasFocus()&&c.length>0&&a.toLowerCase().indexOf(c.toLowerCase())===0&&!this.hasTextOverflow()?b("Input").setValue(this.$SimpleStructuredInput3,c+a.slice(c.length)):this.clearHint()};d.focus=function(){this.$SimpleStructuredInput2.focus()};d.blur=function(){this.$SimpleStructuredInput2.blur(),this.setHint([])};d.hasTextOverflow=function(){return this.$SimpleStructuredInput2.offsetWidth!==this.$SimpleStructuredInput2.scrollWidth};d.hasFocus=function(){return b("DOM").contains(this.$SimpleStructuredInput1,b("getActiveElement")())};d.setStructure=function(a,c){c===void 0&&(c=!1);a=a.map(function(a){return a.text});b("Input").setValue(this.$SimpleStructuredInput2,a.join(""));c!==!0&&this.inform("change")};d.getStructure=function(){return b("FacebarStructuredText").fromString(b("Input").getValue(this.$SimpleStructuredInput2)).toStruct()};d.getSelection=function(){return{offset:this.$SimpleStructuredInput2.selectionStart,length:this.$SimpleStructuredInput2.selectionEnd-this.$SimpleStructuredInput2.selectionStart}};d.setSelection=function(a){this.hasFocus()&&(this.$SimpleStructuredInput2.setSelectionRange(a.offset,a.offset+a.length),this.inform("select"))};d.isSelectionAtEnd=function(){var a=this.getSelection().offset,c=b("Input").getValue(this.$SimpleStructuredInput2).length;return a>=c};d.selectAll=function(){this.setSelection({offset:0,length:b("Input").getValue(this.$SimpleStructuredInput2).length})};c.getInstance=function(a){a=b("Parent").bySelector(a,"._5eaz");if(!(a instanceof HTMLElement))throw new Error("No DOMElement structured input found using");return b("DataStore").get(a,"SimpleStructuredInput")||new c(a)};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a}),null);
__d("SearchBootstrapCache",["AsyncRequest","AsyncResponse","CacheStorage","SearchBootstrapCacheConstants"],(function(a,b,c,d,e,f){var g=1;a={get:function(a,c,d,e,f){var g=this.getKey(a,c,d),h=this.getStorage(),i=h.get(g);h=b("SearchBootstrapCacheConstants")[c.type]||36e5;if(i==null||Date.now()-i.timestamp>h)f(d,a,c);else{g=new(b("AsyncRequest"))();g.getData=function(){return i.requestData};h=new(b("AsyncResponse"))(g,i.payload);e(h,c)}},set:function(a,b,c){var d=a.getRequest().getData();this.getStorage().set(this.getKey(d,b,c),{timestamp:Date.now(),payload:a.payload,requestData:d})},getKey:function(a,b,c){return JSON.stringify({filter:a.filter,context:a.context,viewer:a.viewer,lazy:a.lazy,token:a.token,type:b.type,bootstrapEndpoint:c})},getStorage:function(){return new(b("CacheStorage"))("localstorage","_SearchBootstrapCache_"+g)}};e.exports=a}),null);
__d("SearchSingleState",["fbt"],(function(a,b,c,d,e,f,g){function h(a,b,c,d){return{classNames:"grammar",groupIndex:0,indexInGroup:a,path:b,text:c,type:"grammar",uid:d}}a={getSuggestions:function(a,b,c){if(c==="ent:user")return this.getSuggestionsForUser(a,b);else if(c==="ent:page")return this.getSuggestionsForPage(a,b);else if(c==="ent:app")return this.getSuggestionsForApp(a,b);else if(c==="ent:group")return this.getSuggestionsForGroup(a,b)},getSuggestionsForUser:function(a,b){return[h(0,"/search/"+a+"/photos-of",g._("photos of {full name}",[g._param("full name",b)]),"photos_of_user"),h(1,"/search/"+a+"/friends",g._("friends of {full name}",[g._param("full name",b)]),"friends_of_user"),h(2,"/search/"+a+"/pages-liked",g._("favourite Pages of {full name}",[g._param("full name",b)]),"pages_liked_user"),h(3,"/search/str/"+b+"/users-named",g._("find all people named \"{full name}\"",[g._param("full name",b)]),"people_named_text")]},getSuggestionsForPage:function(a,b){return[h(0,"/search/"+a+"/photos-of",g._("photos of {name of page}",[g._param("name of page",b)]),"photos_of_page"),h(1,"/search/"+a+"/likers",g._("people who like {name of page}",[g._param("name of page",b)]),"page_likers"),h(2,"/search/str/"+b+"/pages-named",g._("find all Pages named \"{name of page}\"",[g._param("name of page",b)]),"pages_named_text")]},getSuggestionsForGroup:function(a,b){return[h(0,"/search/"+a+"/members",g._("{name of group} members",[g._param("name of group",b)]),"members_of_group"),h(1,"/search/"+a+"/photos-in",g._("photos in {name of groups}",[g._param("name of groups",b)]),"photos_in_group"),h(2,"/search/"+a+"/creators",g._("{name of group} creators",[g._param("name of group",b)]),"creators_of_group"),h(3,"/search/"+a+"/admins",g._("{name of group} administrators",[g._param("name of group",b)]),"admins_of_group")]},getSuggestionsForApp:function(a,b){return[h(0,"/search/"+a+"/apps-similar-to",g._("apps similar to {name of app}",[g._param("name of app",b)]),"similar_apps"),h(1,"/search/"+a+"/app-users",g._("people who use {name of app}",[g._param("name of app",b)]),"app_users"),h(2,"/search/str/"+b+"/pages-named",g._("find all apps named \"{name of page}\"",[g._param("name of page",b)]),"apps_named_text")]}};e.exports=a}),null);
__d("SearchDataSource",["Arbiter","AsyncResponse","CSRFGuard","CurrentUserInitialData","DataSource","Event","FacebarJSConstants","HashtagSearchResultUtils","PageTransitionsRegistrar","SearchBootstrapCache","SearchRegion","SearchSingleState","UnicodeCJK","XHRRequest","createArrayFromMixed","debounce"],(function(a,b,c,d,e,f){"use strict";var g,h=100,i="/typeahead/search/facebar/nullstate/";a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){var c;b.headerflags=new Map();c=a.call(this,b)||this;c._updateMaxResults=function(){var a=window.innerHeight||document.documentElement.clientHeight;c.setMaxResults(Math.max(c._numResults.min,Math.min(c._numResults.max,Math.ceil(2+(a-370)/56))))};c._token=b.token||"";c._lazyonload=b.lazyonload!==!1;c._extraTypes=b.extraTypes;c._buckets=b.buckets;c._noMultiFetch=b.noMultiFetch||!1;c._nullStateConfig=b.nullStateConfig||{};var d=b.maxResults||8;c._numResults={min:3,max:d};c.recordingRoute=b.recordingRoute||"non_banzai";c._enabledHashtag=b.enabledHashtag||!1;c.logBackendQueriesWindow=b.logBackendQueriesWindow||25;c._genTime=b.genTime;c._bootstrapError=!1;c._hasKeywordBootstrap=b.hasKeywordBootstrap||!1;c._addJoinedTermsMatching=b.addJoinedTermsMatching||!1;c._useBootstrapCache=b.useBootstrapCache||!1;c._useBrowserCache=b.useBrowserCache||!1;c.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:!0,prefix_kana_drop_trailing_latin:b.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:b.cjkUiCacheHiraganaToKatakana,search_i18n_prefix_arabic_normalization:b.arabicNormalization});c.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:b.cjkDropLatinInCjTokens});return c}var d=c.prototype;d.init=function(){a.prototype.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=!0;this._updateMaxResults();var c=b("debounce")(this._updateMaxResults,h,this,!0);b("Event").listen(window,"resize",c);this._nullStateConfig.prefetchNullState&&this.fetchNullState("");this._nullStateConfig.singleState&&b("Arbiter").subscribe("page_transition",this.handlePageTransition.bind(this));(this._nullStateConfig.prefetchNullState||this._nullStateConfig.singleState)&&b("Arbiter").subscribe("search/updateNullState",this.updateNullState.bind(this));this._nullStateConfig.recent&&b("Arbiter").subscribe("search/refreshRecentSearchesNullstate",this.refreshRecentSearches.bind(this))};d.refreshRecentSearches=function(){this.nullStateData=null};d.handlePageTransition=function(){this.nullStateParams={}};d.updateNullState=function(a,b){this.nullStateParams=b,this.fetchNullState()};d.markResultsAsNullState=function(a){if(a)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.isNullState=!0}};d.markResultsAsSingleState=function(a){if(a)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.isSingleState=!0}};d.fetchNullState=function(a){this.lastNullOrSingleStateFetchStartTime=Date.now();if(!this._nullStateConfig.hasNullState)return;var b=null;this.nullStateParams&&this.nullStateParams.uid?(this.nullStateParams.query=a||"",b=this._fetchDataForSingleState(),this.markResultsAsNullState(b)):(b=this._fetchDataForNullState(),this.markResultsAsSingleState(b));b&&this.inform("respond",{value:this.nullStateParams?this.nullStateParams.query:"",results:b,isAsync:!1,nullState:!0})};d._fetchDataForSingleState=function(){if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==="ent:app"||this.nullStateParams.type==="ent:group"||this.nullStateParams.type==="ent:page"){this.fetch(i,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:!0});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return}var a=b("SearchSingleState").getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!a)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:a,profileID:this.nullStateParams.uid};return a};d._shouldRefreshNullState=function(){if(!this._nullStateConfig.recent)return!1;var a=window.location.href;if(!a)return!1;return a.contains("allactivity")&&a.contains("log_filter=search")?!0:!1};d._fetchDataForNullState=function(){var a=this;if(this.nullStateData&&!this._shouldRefreshNullState()){this.markResultsAsNullState(this.nullStateData);window.setTimeout(function(){a.inform("respond",{value:"",results:a.nullStateData,isAsync:!0,nullState:!0})},0);return}this.fetchingNullState||(this.fetchingNullState=!0,this.fetch(i,{value:""},{nullState:!0,value:""}));return null};d.dirty=function(){a.prototype.dirty.call(this),this._bootstrapError=!1,this._fetchOnUseRequests=[]};d.asyncErrorHandler=function(a,b){b.nullState&&(this.fetchingNullState=!1),b.bootstrap&&(this._bootstrapError=!0),this.inform("fetchError",{response:a,fetch_context:b})};d.fetch=function(c,d,e){e=e||{};e.fetch_start=Date.now();var f=b("PageTransitionsRegistrar").getMostRecentURI().getPath();d=babelHelpers["extends"]({},d,{path:f});a.prototype.fetch.call(this,c,d,e)};d.xhrFetchHandler=function(a,c,d){a=b("CSRFGuard").clean(a);a=JSON.parse(a);return this.fetchHandler(new(b("AsyncResponse"))(null,a.payload),d,c)};d.fetchHandler=function(c,d,e){e===void 0&&(e=null);if(d.nullState){this.fetchingNullState=!1;this.nullStateData=c.getPayload().entries;this.markResultsAsNullState(this.nullStateData);this.inform("respond",{value:"",results:this.nullStateData,isAsync:!0,nullState:!0});return}if(d.singleState){this.nullStateDataWithProfile.data=c.getPayload().entries;this.markResultsAsSingleState(this.nullStateDataWithProfile.data);this.inform("respond",{results:this.nullStateDataWithProfile.data,isAsync:!0,value:this.nullStateParams?this.nullStateParams.query:"",nullState:!0});return}var f=c.getPayload(),g=babelHelpers["extends"]({fetch_end:Date.now()},d),h=g.value?"event":"persistent";this.inform("beginFetchHandler",{response:c});d.bootstrap&&(this._bootstrapError=!1);var i=e===null?c.getRequest().uri.getPath():e.getURI().getPath();i===this.bootstrapEndpoint&&this._useBootstrapCache&&b("SearchBootstrapCache").set(c,d,this.bootstrapEndpoint);if(d.type=="lean")this._leanPayload=f,this._processLean();else{f.coeff2_ts&&(g.coeff2_ts=f.coeff2_ts);a.prototype.fetchHandler.call(this,c,d);i=e===null?c.getRequest().getData():e.getData();d.bootstrap&&!i.no_cache&&(g.browserCacheHit=f.timestamp<this._genTime);d.bootstrap&&!f.no_data&&this._bootstrapRequestsPending>0&&(d.bootstrap=!1,--this._bootstrapRequestsPending,this._bootstrapRequestsPending||this._bootstrapPostProcess());if(f.no_data||f.stale||f.token!==this._token){e=babelHelpers["extends"]({},i);e.lazy&&(delete e.lazy,e.token=this._token,this._fetchOnUse(e,d))}}this.inform("endpointStats",{info:g,response:c},h);d&&!!d.value&&this.inform("completeFetch",{response:c,stats:g})};d.respond=function(a,b,c){this.inform("respondValidUids",b);this.inform("reorderResults",b);b=this.buildData(b,a);b.forEach(function(a,b){a.origIndex=b,a.fromCache=!c});this.inform("respond",{value:a,results:b,isAsync:!!c});return b};d.buildData=function(a,b){if(!a||a.length===0)return[];b=a.map(this.getEntry,this);b.length=Math.min(b.length,this._maxResults);return b};d.fetchLean=function(){this._fetchLean()};d._isQueryTooShort=function(a){return a.length<this._minQueryLength&&!this._performShortQuery&&!b("UnicodeCJK").hasIdeoOrSyll(a)};d.shouldFetchMoreResults=function(a){return a.length<this._maxResults};d._bootstrapPostProcess=function(){var a=0;for(var b in this._data)Object.prototype.hasOwnProperty.call(this._data,b)&&a++;this.inform("bootstrapped",{time:Date.now(),size:a},"persistent");this._processLean()};d._processLean=function(){if(this._leanPayload){var a,b=this._leanPayload.entries;for(var c in b)a=this.getEntry(c),a&&(a.index=b[c]);this.setExclusions(this._leanPayload.blocked);this._leanPayload=null}};d._bootstrapFetch=function(a,b){b=babelHelpers["extends"]({},b,this.bootstrapData);this._criticalOnly&&this._lazyonload&&(b.lazy=1);a={bootstrap:!0,type:a};this._fetchBootstrapMaybeCache(b,a);++this._bootstrapRequestsPending};d._fetchBootstrapMaybeCache=function(a,c){var d=this;if(this._useBootstrapCache)b("SearchBootstrapCache").get(a,c,this.bootstrapEndpoint,this.fetchHandler.bind(this),this.fetch.bind(this));else if(this._useBrowserCache){var e=new(b("XHRRequest"))(this.bootstrapEndpoint).setData(babelHelpers["extends"]({},a,{__user:(g||(g=b("CurrentUserInitialData"))).USER_ID,__a:1})).setMethod("GET").setResponseHandler(function(a){return d.xhrFetchHandler(a,e,c||{})}).setErrorHandler(function(a){return d.asyncErrorHandler(a,c)});this.inform("beforeFetch",{request:e,fetch_context:c});e.send()}else this.fetch(this.bootstrapEndpoint,a,c)};d._fetchOnUse=function(a,b){for(var c in this.bootstrapData)Object.prototype.hasOwnProperty.call(a,c)||(a[c]=this.bootstrapData[c]);this._criticalOnly?this._fetchOnUseRequests.push({args:a,ctx:b}):this._fetchBootstrapMaybeCache(a,b)};d._fetchLean=function(){var a={no_cache:1};a.options=b("createArrayFromMixed")(a.options);a.options.push("lean");this._fetchOnUse(a,{type:"lean"})};d.bootstrap=function(a){a||(this._criticalOnly=!1,this._flushFetchOnUseRequests());if(this._bootstrapped)return;a={filter:["event"]};this._fetchOnUse(a,{type:"event"});a=["app","page","group","friendlist"];a=a.concat(this._extraTypes||[]);var c=[];this._hasKeywordBootstrap&&c.push(b("FacebarJSConstants").keywordType);if(this._noMultiFetch)a.push("user"),a=a.concat(c),this._bootstrapFetch("user",{filter:a});else{this._bootstrapFetch("other",{filter:a});if(this._buckets)for(var a=0;a<this._buckets.length;++a){var d={filter:["user"],buckets:this._buckets[a]};this._bootstrapFetch("user",d)}else this._bootstrapFetch("user",{filter:["user"]});c.length>0&&this._bootstrapFetch("keyword",{filter:c})}this._fetchLean();this._bootstrapped=!0};d.getBootstrapError=function(){return this._bootstrapError};d._flushFetchOnUseRequests=function(){var a=this._fetchOnUseRequests.length;for(var b=0;b<a;++b){var c=this._fetchOnUseRequests[b];this._fetchBootstrapMaybeCache(c.args,c.ctx)}a>0&&this.inform("extra_bootstrap",{time:Date.now()},"persistent");this._fetchOnUseRequests=[]};d.onLoad=function(a,b){this.inform("onload",{time:Date.now()},"persistent"),a&&window.setTimeout(this.bootstrap.bind(this,b),0)};d.mergeUids=function(b,c,d,e){var f=this.getDynamicHashtagResult(e);e&&f&&c.indexOf(f)<=0&&c.unshift(f);f=d[0]?this.getEntry(d[0]):null;var g=c[0]?this.getEntry(c[0]):null;f=f&&f.replace_results?f:null;f=!f&&g&&g.replace_results?g:f;g=a.prototype.mergeUids.call(this,b,c,d,e);if(f){this.inform("backend_topreplace",{});return this.deduplicateByKey([f.uid].concat(g))}return g};d.getTextToIndexFromFields=function(a,b){var c=[],d=a.tokenVersion==="v2";for(var e=0;e<b.length;++e){if(d&&(b[e]==="text"||b[e]==="alias"))continue;var f=a[b[e]];f&&(f=f.join?f.join(" "):f,c.push(f),b[e]=="text"&&this._addJoinedTermsMatching&&(f=f.toLowerCase(),f=f.replace(/ /g,""),c.push(f)))}return c.join(" ")};d.getDynamicHashtagResult=function(a){if(!a||!this._enabledHashtag)return;var c=b("HashtagSearchResultUtils").getHashtagFromQuery(a);if(!c)return;var d="hashtag:"+c,e=this.getEntry(d);e||this.processEntries([b("HashtagSearchResultUtils").makeTypeaheadResult(c)],a);return d};d.tokenizeCache=function(a,b){a=this.cacheUnicodeMatch.prefixMatchPrepare(a);a=this._tokenize(a,b);b=a.tokens;b.length>0&&a.value.startsWith("@")&&(b[0]="@"+b[0]);return a};return c}(b("DataSource"));e.exports=a}),null);
__d("SearchTypeaheadRecorder",["AsyncRequest","Banzai","BanzaiNectar","BanzaiScuba","CurrentUser","Event","FacebarGlobalOptions","Keys","TokenizeUtil","Vector","clickRefAction","ge","mapObject","throttle","whitelistObjectKeys"],(function(a,b,c,d,e,f){var g,h={WAITING:"WAITING",SUCCESS:"SUCCESS",NO_RESULTS:"NO_RESULTS",ERROR:"ERROR"};a=function(){"use strict";function a(a){this.init(a),this.initEvents(a)}var c=a.prototype;c.init=function(a){this.core=a.getCore();this.data=a.getData();this.view=a.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};this.allFromSingleState=!1;this.allFromNullState=!1;a=b("ge")("search_first_focus");this.initStartTime=a&&a.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset()};c._reset=function(){this.stats={};this.avgStats={};this.appendStats={};this._backspacing=!1;this.backendQueries=[];this.backendQueriesStatus={};this._topreplace=!1;this._inflightRequests={};var a=Math.random().toString();this.data.setQueryData({sid:a});this.view.setSid(a);this.recordStat("sid",a);this.recordStat("keypressed",0)};c.initEvents=function(){var a=this;this.core.subscribe("focus",function(a){if(!this.stats.session_start_time){this.recordStat("session_start_time",Date.now());a=new Date();a=a.getTimezoneOffset();a=Date.now()-a*60*1e3;this.recordStat("session_start_time_user_timezone",a);this._lastRenderTime=0;this._firstKeypressTime=null}}.bind(this));this.core.subscribe("blur",function(a){a=Date.now();for(var b in this._inflightRequests){var c=this._inflightRequests[b];c=a-c;this.recordAvgStat("search_endpoint_ms_from_js",c)}this.recordStat("session_end_time",a);this.submit()}.bind(this));this.view.subscribe("select",function(a,b){this.recordStat("time_between_select_and_last_render",Date.now()-this._lastRenderTime),this._firstKeypressTime!=null&&this.recordStat("keypress_to_select_time",Date.now()-this._firstKeypressTime),this.recordSelectInfo(b)}.bind(this));this.view.subscribe("render",function(a,b){this._lastRenderTime=Date.now(),this.recordRender(b)}.bind(this));this.data.subscribe("logPerformanceTiming",function(b,c){a.performanceTimings[c.field]=c.value});this.data.subscribe("logProxygenForkPoolId",function(b,c){a.recordStat(c.field,c.value)});this.data.subscribe("activity",function(a,b){this.recordStat("pending_request",b.activity)}.bind(this));this.data.subscribe("respondValidUids",function(a,b){this.validUids=b.slice(0)}.bind(this));this.data.subscribe("beforeQuery",function(a,b){if(!b.value){this.query="";this.results=[];this.data.lastNullOrSingleStateFetchStartTime=Date.now();return}this.stats.first_query_time||this.recordStat("first_query_time",Date.now());this.query=b.value;this.queryStartTime||(this.queryStartTime=[]);this.queryStartTime[this.query]=Date.now();this.recordCountStat("num_queries")}.bind(this));this.data.subscribe("queryEndpoint",function(a,b){this.recordCountStat("num_search_ajax_requests"),this.recordAvgStat("endpoint_query_length",b.value.length),this._inflightRequests[b.value]=Date.now()}.bind(this));this.data.subscribe("onload",function(a,b){this._onloadTime=b.time}.bind(this));this.data.subscribe("bootstrapped",function(a,b){this.bootstrapStats.endTime=b.time,this.bootstrapStats.bootstrapped=1}.bind(this));this.core.subscribe("recordFunction",function(a,b){this._extraRecorder.push(b)}.bind(this));this.data.subscribe("endpointStats",function(a,b){a=b.info;b=a.fetch_end-a.fetch_start;a.value?this.recordAvgStat("search_endpoint_ms_from_js",b):this.bootstrapStats[a.type]=b;a.coeff2_ts&&(this.bootstrapStats.coeff2_ts=a.coeff2_ts);typeof a.browserCacheHit!=="undefined"&&this.recordCountStat(a.browserCacheHit?"bootstrap_cachehits":"bootstrap_cachemisses");this._inflightRequests[a.value]&&delete this._inflightRequests[a.value]}.bind(this));this.data.subscribe("fetchComplete",function(b,c){b=c.entries;c=c.value;c&&a.backendQueriesStatus[c]&&(a._addDurationForBackendQuery(a.backendQueriesStatus[c]),a.backendQueriesStatus[c].status=b&&b.length>0?h.SUCCESS:h.NO_RESULTS)});this.data.subscribe("fetchError",function(b,c){b=c.fetch_context;c=b.value;if(b.bootstrap||!c)return;a.backendQueriesStatus[c]&&(a.backendQueriesStatus[c].status=h.ERROR,a._addDurationForBackendQuery(a.backendQueriesStatus[c]))});this.data.subscribe("query",function(a,b){this.recordAvgStat("num_results_from_cache",b.results.length)}.bind(this));this.data.subscribe("backend_topreplace",function(a,b){!1===this._topreplace&&(this.recordStat("backend_topreplace",1),this._topreplace=!0)}.bind(this));this.data.subscribe("completeFetch",function(a,b){if(this.core.scubaInfo){a=b.response;b={recv:b.stats.fetch_end-b.stats.fetch_start,render:Date.now()-b.stats.fetch_start,payload_size:JSON.stringify(a).length};a.payload.entities||(a.payload.entities=this.buildResults());this.logToScuba(a,b,this.core.scubaInfo,this.query,this.type)}}.bind(this));this.data.subscribe("completeCacheFetch",b("throttle")(function(b,c){a.core.scubaInfo&&a.logToScuba({},{},a.core.scubaInfo,a.query,a.type)},500));b("Event").listen(this.element,"keydown",function(a){this.recordStat("keypressed",1),this.recordCountStat("count_keys_pressed"),b("Event").getKeyCode(a)==b("Keys").BACKSPACE?!this._backspacing&&this.query&&(this._backspacing=!0,this.recordAppendStat("before_backspace_queries",this.query)):this._backspacing=!1,this._firstKeypressTime==null&&(this._firstKeypressTime=Date.now())}.bind(this));this.data.subscribe("beforeFetch",function(a,b){a=b.request.data?b.request.data.value:null;if(!a)return;this.backendQueries.push(a);this.backendQueriesStatus[a]={status:h.WAITING,start_time:Date.now()}}.bind(this))};c.recordStat=function(a,b){this.stats[a]=b};c.recordCountStat=function(a){var b=this.stats[a];this.stats[a]=b?b+1:1};c.recordAvgStat=function(a,b){this.avgStats[a]?(this.avgStats[a][0]+=b,++this.avgStats[a][1]):this.avgStats[a]=[b,1]};c.recordAppendStat=function(a,b){Object.prototype.hasOwnProperty.call(this.appendStats,a)||(this.appendStats[a]=[]),this.appendStats[a].push(b)};c.recordRender=function(a){this.results=a.filter(function(a){return a.uid!="search"&&a.type!="disabled_result"&&a.type!="header"}).map(function(a){return babelHelpers["extends"]({},a)});a=null;this.queryStartTime&&(a=this.queryStartTime[this.query]);var c=this.results.every(function(a){return a.fromCache||a.isSeeMore}),d=this.results.every(function(a){return a.isFromGSEF||a.fromCache||a.isSeeMore||a.isJSBootstrapMatch})&&this.results.some(function(a){return a.isFromGSEF}),e=this.results.every(function(a){return a.isGloballyCachedKeyword||a.fromCache||a.isSeeMore||a.isJSBootstrapMatch})&&this.results.some(function(a){return a.isGloballyCachedKeyword}),f=this.results.every(function(a){return a.isNullState}),g=this.results.every(function(a){return a.isSingleState}),h=this.results.every(function(a){return a.exactMatchKeyword||a.isSeeMore});this.allFromSingleState=g;this.allFromNullState=f;if(this.results.length&&this.data.lastNullOrSingleStateFetchStartTime&&f)this.recordStat("time_render_null_state",Date.now()-this.data.lastNullOrSingleStateFetchStartTime),this.data.lastNullOrSingleStateFetchStartTime=null;else if(this.data.lastNullOrSingleStateFetchStartTime&&this.results.length&&g)this.recordStat("time_render_single_state",Date.now()-this.data.lastNullOrSingleStateFetchStartTime);else if(a){f=Date.now()-a;h?this.recordAppendStat("times_render_gs_echo",f):this.recordAppendStat(c?"times_render_local":"times_render_remote",f);!c&&d&&this.recordAppendStat("time_render_gs_early_fetch",f);!c&&e&&this.recordAppendStat("time_render_globally_cached_keywords",f);!c&&!d&&!e&&this.recordAppendStat("time_render_remote_main_call",f)}this.data.lastNullOrSingleStateFetchStartTime=null;g=b("Vector").getViewportDimensions();this.recordStat("window_size_width",g.x);this.recordStat("window_size_height",g.y);this.results.length>0&&!this.stats.first_result_time&&this.recordStat("first_result_time",Date.now());a="typed";this.allFromNullState?a="nullstate":this.allFromSingleState&&(a="singlestate");this.recordStat("last_state",a)};c.recordSelectInfo=function(a){var c=a.selected,d=a.index;c.groupIndex!==void 0&&(d=a.index-c.groupIndex-1);var e={href:c.path},f=c.dataGT?{gt:JSON.parse(c.dataGT)}:{};b("clickRefAction")("click",e,null,null,f);if(c.uid=="search"||c.uid=="people_search")this.recordStat("selected_position",this.results!=null?this.results.length:0),this.recordStat("selected_search",1);else if(c.uid=="invite")this.recordStat("selected_invite",1);else{e=c.log_type||c.rankType||c.render_type||c.type;f=e=="friend"?"user":e;this.recordStat("selected_"+f,1);this.recordStat("selected_position",d);this.recordStat("selected_type",e);this.recordStat("selected_name_length",c.text.length);this.recordStat("selected_id",c.uid);this.recordStat("selected_degree",c.bootstrapped?1:2);this.recordStat("selected_recent_search",c.recent_search);f=b("TokenizeUtil").parse(this.data.getTextToIndex(c)).tokens;d=i(f,this.query);d&&this.recordStat("matched_terms",d);this.recordStat("selected_text",c.text)}var g={};this._extraRecorder.forEach(function(b){b(a,this.results,g)}.bind(this));this.recordStat("extra_select_info",JSON.stringify(g));this.recordStat("selected_with_mouse",a.clicked?1:0)};c._addDurationForBackendQuery=function(a){a.start_time&&(a.duration=Date.now()-a.start_time,delete a.start_time)};c._dataToSubmit=function(){this.recordStat("candidate_results",this.buildResults());this.recordStat("query",this.query);this.recordStat("init_time",this.initTime);this.initStartTime&&(this.recordStat("init_start_time",this.initStartTime),this.recordStat("onload_time",this._onloadTime),this.initStartTime=0);this.recordStat("bootstrapped",this.bootstrapStats.bootstrapped);this.bootstrapStats.endTime&&(this.recordStat("bootstrapped_time",this.bootstrapStats.endTime),this.recordStat("user_bootstrap_ms",this.bootstrapStats.user),this.recordStat("other_bootstrap_ms",this.bootstrapStats.other),this.bootstrapStats.endTime=0);var a=this.data.getBootstrapError();a&&this.recordStat("bootstrap_error",1);this.recordStat("coeff2_ts",this.bootstrapStats.coeff2_ts);this.recordStat("max_results",this.data._maxResults);if(this.backendQueries.length>0){this.backendQueries.length>this.data.logBackendQueriesWindow&&(this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow));this.recordStat("backend_queries",this.backendQueries);a=b("whitelistObjectKeys")(this.backendQueriesStatus,this.backendQueries);(g||(g=b("mapObject")))(a,this._addDurationForBackendQuery,this);this.recordStat("backend_queries_status",a)}if(b("FacebarGlobalOptions").taSessionLoggingSample){var c=[];this.results.forEach(function(a){c.push([a.text||"",a.category||"",a.subtext||""])});this.recordStat("raw_suggestions_text",c)}a=this.stats;for(var d in this.avgStats){var e=this.avgStats[d];a[d]=e[0]/e[1]}for(var f in this.appendStats)a[f]=JSON.stringify(this.appendStats[f]);return a};c.buildResults=function(){var a=(this.results||[]).map(function(a,c){var d=b("TokenizeUtil").parse(this.data.getTextToIndex(a)).tokens,e=a.rankType||a.render_type||a.type,f=a.log_type,g=a.bootstrapped?1:0,h=a.s_token||"",j=typeof a.index==="undefined"?100:a.index;d=i(d,this.query)||this.query;var k=a.index_rank,l=a.match_type,m=a.l_type,n=a.vertical_type,o=a.prefix_match,p=a.prefix_length,q=a.text,r=a.category,s=a.subtext,t=a.fromCache,u=a.isNullState,v=a.isSingleState,w=a.logInfo;return typeof a.groupIndex==="number"?[a.groupIndex,a.indexInGroup,a.uid,e,g,h,d,k,l,o,p,a.origIndex,m,n,q,r,s,j,t,u,v,w,f]:[0,c,a.uid,e,g,h,d,k,l,o,p,a.origIndex,m,n,q,r,s,j,t,u,v,w,f]}.bind(this));return JSON.stringify(a)};c.submit=function(){var a=this._dataToSubmit();switch(this.data.recordingRoute){case"banzai_vital":b("Banzai").post(this._banzaiRoute,a,{delay:0,retry:!0});break;default:this.submitThroughAsyncRequest(a)}this._reset()};c.addLatencyToSample=function(a,b,c,d){a.addInteger(d+"query_start",c.queryStart),a.addInteger(d+"query_end",c.queryEnd),a.addInteger(d+"keypress_query_end",c.keyPressToQueryEnd),a.addInteger(d+"render",c.render),a.addInteger(d+"keypress_render",c.keyPressToRender),b[d+"query_start"]=c.queryStart,b[d+"query_end"]=c.queryEnd,b[d+"keypress_query_end"]=c.keyPressToQueryEnd,b[d+"render"]=c.render,b[d+"keypress_render"]=c.keyPressToRender};c.logToScuba=function(a,c,d,e,f){var g=this,h={},i=new(b("BanzaiScuba"))("search_facebar_js",null,{addBrowserFields:!0,addPredictedGeographyFields:!0,addUser:!0,addSearchVersion:!0,addGatekeepers:{facebarGKs:!0}});i.addInteger("sample_rate",d.sample_rate);h.sample_rate=d.sample_rate;i.addNormal("site",d.site);h.site=d.site;i.addDenorm("query",e);h.query=e;d=a.payload||{};d.entities&&(i.addInteger("num_entities",d.entities.length),h.num_entities=d.entities.length);Object.keys(this.performanceTimings).forEach(function(a){i.addInteger(a,g.performanceTimings[a]),h[a]=g.performanceTimings[a]},this);if(d.results||d.entries){var j=(d.results||d.entries).length;i.addInteger("num_results",j);h.num_results=j}d.gzipped_payload_size!==void 0&&(i.addInteger("gzipped_payload_size",d.gzipped_payload_size),h.gzipped_payload_size=d.gzipped_payload_size);c.recv&&c.render>c.recv&&(i.addInteger("time_render",c.render-c.recv),h.time_render=c.render-c.recv,i.addInteger("time_js_async",c.recv),h.time_js_async=c.recv);c.payload_size&&(i.addInteger("payload_size",c.payload_size),h.payload_size=c.payload_size);this.stats.time_render_null_state&&(!e||e.length===0)&&(i.addInteger("time_render_null_state",this.stats.time_render_null_state),h.time_render_null_state=this.stats.time_render_null_state);i.addInteger("query_id",a.queryId);h.query_id=a.queryId;i.addDenorm("user_id",b("CurrentUser").getID());h.user_id=b("CurrentUser").getID();i.addDenorm("session_id",this.stats.sid);h.session_id=this.stats.sid;i.addNormal("typeahead_type",f);h.typeahead_type=f;c.remoteQueryLatencies&&(this.addLatencyToSample(i,h,c.remoteQueryLatencies,"remote_"),i.addInteger("remote_keypress_query_dispatch",c.remoteQueryLatencies.keyPressToQueryDispatch),h.remote_keypress_query_dispatch=c.remoteQueryLatencies.keyPressToQueryDispatch,i.addInteger("remote_keypress_query_start",c.remoteQueryLatencies.keyPressToQueryStart),h.remote_keypress_query_start=c.remoteQueryLatencies.keyPressToQueryStart,i.addNormal("inflight_requests",c.remoteQueryLatencies.inflightRequests),i.addInteger("inflight_requests",c.remoteQueryLatencies.inflightRequests),h.inflight_requests=c.remoteQueryLatencies.inflightRequests,i.addNormal("waiting_queries",c.remoteQueryLatencies.waitingQueries),i.addInteger("waiting_queries",c.remoteQueryLatencies.waitingQueries),h.waiting_queries=c.remoteQueryLatencies.waitingQueries);c.cacheQueryLatencies&&this.addLatencyToSample(i,h,c.cacheQueryLatencies,"cache_");i.post();b("BanzaiNectar").log("search_facebar_js","typeahead",h)};c.submitThroughAsyncRequest=function(a){Object.keys(a).length>0&&new(b("AsyncRequest"))().setURI(this._endPoint).setMethod("POST").setData({stats:a}).setOption("handleErrorAfterUnload",!0).setErrorHandler(function(c){a.retry=!0,new(b("AsyncRequest"))().setURI(this._endPoint).setMethod("POST").setData({stats:a}).setOption("asynchronous_DEPRECATED",!1).send()}.bind(this)).send()};return a}();var i=function(a,c){if(!a||!c)return;c=b("TokenizeUtil").parse(c);if(c.flatValue[c.flatValue.length-1]===" ")return c.flatValue;var d=c.tokens[c.tokens.length-1],e={};a.forEach(function(a){e[a]=(e[a]||0)+1});var f={};c=c.tokens.slice(0,c.tokens.length-1);c.forEach(function(a){f[a]=(f[a]||0)+1});for(var g=0;g<a.length;++g){var h=a[g];if(h.indexOf(d)===0&&e[h]-(f[h]||0)>0){c.push(h);return c.join(" ")}}return void 0};Object.assign(a.prototype,{_endPoint:"/ajax/typeahead/record_metrics.php",_banzaiRoute:"search"});e.exports=a}),null);
__d("XSearchFacebarSurveyController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/search/facebar_survey/",{id:{type:"String",required:!0},query:{type:"String"},session_id:{type:"String",required:!0},on_session_start:{type:"Exists",defaultValue:!1},result_selected:{type:"Exists",defaultValue:!1}})}),null);
__d("AbandonedSessionSurvey",["AsyncRequest","SubscriptionsHandler","XSearchFacebarSurveyController","getOrCreateDOMID"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a){var c=this;this.tryToSubmitSurvey=function(){c.searchBoxFocused&&(c.openSurvey(),c.resultSelected=!1,c.searchBoxFocused=!1)};this.core=a.getCore();this.data=a.getData();this.view=a.getView();this.subscriptionsHandler=new(b("SubscriptionsHandler"))()}var c=a.prototype;c.enable=function(){var a=this;this.subscriptionsHandler.addSubscriptions(this.core.subscribe("focus",function(){a.searchBoxFocused=!0,a.resultSelected=!1}),this.data.subscribe("beforeQuery",function(b,c){a.query=c.value||""}),this.view.subscribe("select",function(){a.resultSelected=!0,a.tryToSubmitSurvey()}),this.core.subscribe("blur",this.tryToSubmitSurvey))};c.disable=function(){this.subscriptionsHandler.release(),this.request&&this.request.abort()};c.openSurvey=function(){if(this.openedSurvey)return;this.openedSurvey=!0;var a=this.core.element;a==null&&(a=this.core.getElement());var c=this.normalizeValue(this.query);a=b("XSearchFacebarSurveyController").getURIBuilder().setString("id",b("getOrCreateDOMID")(a)).setString("query",c!=null?c:"").setString("session_id",this.data.queryData.sid).setExists("result_selected",this.resultSelected);this.request=new(b("AsyncRequest"))().setMethod("POST").setAllowCrossPageTransition(!0).setURI(a.getURI());this.request.send()};c.normalizeValue=function(a){return String(a).trim().replace(/\s+/g," ").replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,"").toLowerCase()};return a}();e.exports=a}),null);
__d("FluxHooks",["FluxContainerSubscriptions","React","shallowEqual","useSubscriptionValue"],(function(a,b,c,d,e,f){"use strict";d=b("React");var g=d.useCallback,h=d.useEffect,i=d.useRef,j=d.useState;function a(a,c){var d=g(function(d){var e=c(a);return d!=null&&b("shallowEqual")(d,e)?d:e},[a,c]),e=g(function(b){var c=a.addListener(b);return function(){return c.remove()}},[a]);return b("useSubscriptionValue")({getCurrentValue:d,subscribe:e})}function c(a,c,d){var e=g(function(c){var d=a(c);return c!=null&&b("shallowEqual")(c,d)?c:d},d),f=g(function(a){if(c.length===0)return function(){};var d=new(b("FluxContainerSubscriptions"))("useCalculateState");d.setStores(c);d.addListener(a);return function(){return d.reset()}},c);d=j(function(){return e()});var k=d[0],l=d[1];d=function(){l(e)};var m=i(d);m.current=d;var n=j(function(){return e}),o=n[0];n=n[1];o!==e&&(n(function(){return e}),d());h(function(){var a=!1,b=function(){a||m.current()},c=f(b);m.current();return function(){a=!0,c()}},[m,f]);return[k,l]}e.exports={useFluxStore:a,useCalculateState:c}}),null);
__d("SearchSuggestionsHighlighter",["React","escapeRegex"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a,c,d,e,f){a=b("escapeRegex")(f?a:a.trim());e=e?"gi":"g";var h=" "+c,i=[];f=f?new RegExp("( "+a.split(/\s+/).join("| ")+")",e):new RegExp("("+a.split(/\s+/).join("|")+")",e);a=0;e=null;while(!0){e=f.exec(h);if(e==null)break;var j=h.substring(a,e.index);a===0&&(j=j.trimLeft());d?i.push(j):i.push(g.jsx("strong",{children:j},c+"-"+e.index));j=e[0];e.index===0&&(j=j.trimLeft());a=e.index+e[0].length;d?i.push(g.jsx("strong",{children:j},c+"-"+a)):i.push(j)}d?i.push(h.substring(a,h.length)):i.push(g.jsx("strong",{children:h.substring(a,h.length)},c+"-"+h.length));return i}function a(a,b,c){c===void 0&&(c=!0);return h(a,b,!0,!1,c)}function c(a,b,c){c===void 0&&(c=!0);return h(a,b,!1,!1,c)}function d(a,b,c){c===void 0&&(c=!0);return h(a,b,!0,!0,c)}function f(a,b,c){c===void 0&&(c=!0);return h(a,b,!1,!0,c)}e.exports={highlightMatch:a,highlightNonMatch:c,highlightMatchCaseInsensitive:d,highlightNonMatchCaseInsensitive:f}}),null);