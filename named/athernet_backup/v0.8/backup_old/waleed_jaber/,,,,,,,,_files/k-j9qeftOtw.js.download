if (self.CavalryLogger) { CavalryLogger.start_js(["\/I4U4"]); }

__d("VideoComponentLiveEndScreenQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"videoID",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"videoID"}],c=[{kind:"ScalarField",alias:null,name:"text",args:null,storageKey:null}],d={kind:"LinkedField",alias:"liveEndText",name:"live_end_text",storageKey:null,args:null,concreteType:"TextWithEntities",plural:!1,selections:c};c={kind:"LinkedField",alias:"liveEndFollowPromptText",name:"live_end_follow_prompt_text",storageKey:null,args:null,concreteType:"TextWithEntities",plural:!1,selections:c};var e={kind:"ScalarField",alias:"isLiveAudioFormat",name:"is_live_audio_format",args:null,storageKey:null},f={kind:"LinkedField",alias:"profilePicture",name:"profile_picture",storageKey:"profile_picture(height:70,width:70)",args:[{kind:"Literal",name:"height",value:70},{kind:"Literal",name:"width",value:70}],concreteType:"Image",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"uri",args:null,storageKey:null}]},g={kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},h={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"VideoComponentLiveEndScreenQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:"video",name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"InlineFragment",type:"Video",selections:[d,c,e,{kind:"LinkedField",alias:null,name:"owner",storageKey:null,args:null,concreteType:null,plural:!1,selections:[f]}]}]}]},operation:{kind:"Operation",name:"VideoComponentLiveEndScreenQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:"video",name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[g,h,{kind:"InlineFragment",type:"Video",selections:[d,c,e,{kind:"LinkedField",alias:null,name:"owner",storageKey:null,args:null,concreteType:null,plural:!1,selections:[g,f,h]}]}]}]},params:{operationKind:"query",name:"VideoComponentLiveEndScreenQuery",id:"1697410810295955",text:null,metadata:{}}}}();e.exports=a}),null);
__d("VideoComponentLiveInterruptedScreenQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"videoID",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"videoID"}],c={kind:"InlineFragment",type:"Video",selections:[{kind:"ScalarField",alias:"isLiveAudioFormat",name:"is_live_audio_format",args:null,storageKey:null}]};return{kind:"Request",fragment:{kind:"Fragment",name:"VideoComponentLiveInterruptedScreenQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:"video",name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[c]}]},operation:{kind:"Operation",name:"VideoComponentLiveInterruptedScreenQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:"video",name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},c]}]},params:{operationKind:"query",name:"VideoComponentLiveInterruptedScreenQuery",id:"1713690985379819",text:null,metadata:{}}}}();e.exports=a}),null);
__d("ChannelSubdomain",["Event","JSLogger","Run","LogHistory","clearTimeout","setTimeoutAcrossTransitions","WebStorage"],(function(a,b,c,d,e,f){var g,h=b("LogHistory").getInstance("channel"),i=b("JSLogger").create("channel"),j="channel_sub:",k=7,l=100*1e3,m=null,n=null;function o(){var a=(g||(g=b("WebStorage"))).getLocalStorage();n&&(b("clearTimeout")(n),n=null);a&&m!=null&&a.removeItem(j+m);m=null}function a(a,c,d){d===void 0&&(d=!1);a=(a-1)*k;d&&(n&&b("clearTimeout")(n),m=n=null);c==null&&(c=Math.floor(Math.random()*a));if(m==null){var e=(g||(g=b("WebStorage"))).getLocalStorage();if(e){d=[];for(var f=0;f<e.length;f++){var p=e.key(f);if(p!=null&&p.indexOf(j)===0){var q=parseInt(p.substr(j.length),10);d[q]=parseInt(e.getItem(p),10)}}q=Date.now()-l;for(var p=0;p<a;p++){f=(p+c)%a;if(!d[f]||d[f]<q){m=f;break}}if(m!=null){f=function a(){if(m==null)return;try{e.setItem(j+m,Date.now().toString())}catch(a){h.warn("subdomain set failed",a.message)}n=b("setTimeoutAcrossTransitions")(a,l/2)};f()}else h.warn("no channel subdomain",d),i.error("subdomain_overflow");typeof window.onpageshow!=="undefined"?b("Event").listen(window,"pagehide",o):b("Run").onUnload(o)}else m=c}return m==null?null:m%k}e.exports={allocate:a,clear:o}}),null);
__d("ChatproxyClientErrorsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAppVersion=function(a){this.$1.app_version=a;return this};c.setBatchSize=function(a){this.$1.batch_size=a;return this};c.setErrorMessage=function(a){this.$1.error_message=a;return this};c.setErrorReason=function(a){this.$1.error_reason=a;return this};c.setErrorText=function(a){this.$1.error_text=a;return this};c.setJsEventTimeMs=function(a){this.$1.js_event_time_ms=a;return this};c.setMultiViewSubscription=function(a){this.$1.multi_view_subscription=a;return this};c.setRequestID=function(a){this.$1.request_id=a;return this};c.setResponseHeaders=function(a){this.$1.response_headers=a;return this};c.setSessionID=function(a){this.$1.session_id=a;return this};c.setSessionIDStr=function(a){this.$1.session_id_str=a;return this};c.setStatusCode=function(a){this.$1.status_code=a;return this};c.setSubscriberID=function(a){this.$1.subscriber_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTopicPrefixes=function(a){this.$1.topic_prefixes=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setURL=function(a){this.$1.url=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.setXhrReadyState=function(a){this.$1.xhr_ready_state=a;return this};c.setXhrStatus=function(a){this.$1.xhr_status=a;return this};return a}();c={app_version:!0,batch_size:!0,error_message:!0,error_reason:!0,error_text:!0,js_event_time_ms:!0,multi_view_subscription:!0,request_id:!0,response_headers:!0,session_id:!0,session_id_str:!0,status_code:!0,subscriber_id:!0,time:!0,topic_prefixes:!0,url:!0,weight:!0,xhr_ready_state:!0,xhr_status:!0};e.exports=a}),null);
__d("DocRPC",["ErrorUtils","FBLogger"],(function(a,b,c,d,e,f){var g,h={_apis:{},_dispatch:function(a){var c;try{a=JSON.parse(a)}catch(b){throw new Error('DocRPC unparsable dispatch: "'+a+'"')}if(Object.prototype.hasOwnProperty.call(h._apis,a.api)){var d=h._apis[a.api];d[a.method]&&(c=(g||(g=b("ErrorUtils"))).applyWithGuard(d[a.method],d,a.args))}c===void 0&&(c=null);return JSON.stringify(c)},publish:function(a,b){h._apis[b]=a},proxy:function(a,c,d){var e={};d.forEach(function(d){e[d]=function(){var e={api:c,method:d,args:Array.prototype.slice.call(arguments)},f;try{if(a.closed)throw new Error("DocRPC window closed");f=a.DocRPC._dispatch(JSON.stringify(e))}catch(a){b("FBLogger")("doc_rpc").catching(a).warn("Encountered an error duing proxy call");return}if(typeof f==="string")try{f=JSON.parse(f)}catch(a){b("FBLogger")("doc_rpc").catching(a).mustfix("DocRPC %s.%s unparsable return: %s",c,d,f);throw new Error("DocRPC "+c+"."+d+' unparsable return: "'+f+'"')}return f}});return e}};e.exports=a.DocRPC=h}),null);
__d("ChannelTransport",["AjaxRequest","BanzaiODS","ChannelConstants","ChatproxyClientErrorsTypedLogger","DocRPC","LogHistory","MessengerMQTTGating","TimeSlice","URI","bind","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g,h="BROWSER_REFUSED_TO_GET_FAILURE_REASON_HEADER",i=b("LogHistory").getInstance("channel");function j(a){var c=new(b("ChatproxyClientErrorsTypedLogger"))();c.setStatusCode(a.status);if(a.xhr!=null){var d;try{d=a.xhr.getResponseHeader("x-fb-chat-failure-reason")}catch(a){d=h}d&&c.setErrorReason(d)}c.setErrorMessage(a.errorType);a.uri!==void 0&&c.setURL(a.uri.getPath());c.log()}function k(){return(1048576*Math.random()|0).toString(36)}function l(a){return a!==null&&a!==void 0&&!isNaN(a)&&isFinite(a)&&0<=a&&a<=6}function m(a,c){var d="";l(a.subdomain)&&(d=a.subdomain+"-");var e=a.host;e=e===null||e===void 0?"edge-chat":a.host;c=new(g||(g=b("URI")))(c).setDomain(d+e+"."+a.domain).setPort(a.port).setSecure(new g(window.location.href).isSecure());return c}function n(a){var c={partition:a.partition,cb:k(),failure:a.pingFailuresOnSubdomain};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);c=m(a,"/p").setQueryData(c);i.log("start_p",{uri:c.toString()});var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);var e=function(b){i.log("finish_p",{xhr:b.toJSON?b.toJSON():b,subdomain:a.subdomain,fullHost:a.fullHost})};d.onError=function(c){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendP.error");j(d);e(c);if(a.subdomain===null)return;l(a.subdomain)&&(a.pingFailuresOnSubdomain++,a.subdomain++,a.subdomain>6&&(a.subdomain=0))};d.timeout=a.P_TIMEOUT;d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendP.success"),e(a)};d.send()}function o(a,c,d){var e=new Image(),f=0,g=function(a){e.abort();return a?c():d()};e.onload=b("TimeSlice").guard(function(){i.log("ping_ok",{duration:Date.now()-f}),b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPing.success"),g(!0)},"ChannelTransport image.onload");e.onerror=b("TimeSlice").guard(function(){n(a),b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPing.error"),j(e),g(!1)},"ChannelTransport image.onerror");var h=b("setTimeoutAcrossTransitions")(e.onerror,1e4);e.abort=function(){h&&(b("clearTimeout")(h),h=null),e.onload=e.onerror=null};var l={partition:a.partition,cb:k()};a.sticky_token&&(l.sticky_token=a.sticky_token);a.sticky_pool&&(l.sticky_pool=a.sticky_pool);a.lastRequestErrorReason&&(l.reason=a.lastRequestErrorReason,a.lastRequestErrorReason=null);a.uid&&a.viewerUid&&(l.uid=a.uid,l.viewer_uid=a.viewerUid);f=Date.now();e.src=m(a,"/ajax/chatproxy-ping").setQueryData(l);return e}function a(a,c){var d={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:k(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(d.sticky_token=a.sticky_token);a.sticky_pool&&(d.sticky_pool=a.sticky_pool);a.profile&&(d.profile=a.profile);a.capabilities&&(d.cap=a.capabilities);d.id=c;c=m(a,"/add_bud").setQueryData(d);var e=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(e.xhr.withCredentials=!0);e.onError=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendAdditionalBuddy.error"),i.warn("add_buddy_error"),j(e)};e.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendAdditionalBuddy.success"),i.log("add_buddy_ok")};e.timeout=a.P_TIMEOUT;e.send()}function c(a){var c={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:k(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);a.is_offline||a.shouldSuppressPresence?c.state="offline":c.state="active";if(c.state===a.lastPresenceState)return;a.lastPresenceState=c.state;a.profile&&(c.profile=a.profile);a.capabilities&&(c.cap=a.capabilities);c=m(a,"/active_ping").setQueryData(c);var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);d.onError=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendActivePing.error"),i.warn("active_ping_error"),j(d)};d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendActivePing.success"),i.log("active_ping_ok")};d.timeout=a.P_TIMEOUT;d.send()}function p(a,c,d,e){var f=new Date(),g=-1;a.userActive>0&&(g=(f-a.userActive)/1e3|0,g<0&&i.warn("idle_regression",{idleTime:g,now:f.getTime(),userActive:a.userActive}));f={channel:a.user_channel,seq:a.seq,partition:a.partition,clientid:a.sessionID,cb:k(),idle:g,qp:"y",cap:0};a.state.aiq&&(f.aiq=a.state.aiq);f.iris_enabled=!b("MessengerMQTTGating").isEnabled();b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","iris_enabled."+(f.iris_enabled?"true":"false"));a.ready&&((a.seqTurSentAt==-1||a.seqTurSentAt==a.seq)&&(f.tur=a.timeUntilReady,f.qpmade=a.queueMade,a.seqTurSentAt=a.seq));f.pws=a.pws;a.sequenceId>0&&(f.isq=a.sequenceId);f.msgs_recv=a.estimatedReceived;a.uid&&a.viewerUid&&(f.uid=a.uid,f.viewer_uid=a.viewerUid);a.sticky_token?f.sticky_token=a.sticky_token:(f.request_batch=1,a.msgr_region&&(f.msgr_region=a.msgr_region));a.sticky_pool&&(f.sticky_pool=a.sticky_pool);"trace_id"in a&&(f.traceid=a.trace_id);a.is_offline||a.shouldSuppressPresence?f.state="offline":a.userActive>0&&g<60&&(f.state="active");a.lastPresenceState=f.state;a.streamingCapable&&(f.mode="stream",f.format="json");a.profile&&(f.profile=a.profile);a.capabilities&&(f.cap=a.capabilities);g=m(a,"/pull").setQueryData(f);f="GET";var h=new(b("AjaxRequest"))(f,g);b("AjaxRequest").supportsCORS()&&(h.xhr.withCredentials=!0);h.timeout=a.streamingCapable?a.STREAMING_TIMEOUT:a.LONGPOLL_TIMEOUT;h.onJSON=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.json"),c(a)};h.onSuccess=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.success"),d(a)};h.onError=function(){var c=this.status==12002&&this._time>=a.MIN_12002_TIMEOUT||this.status==504&&this._time>=a.MIN_504_TIMEOUT,f=c?d:e;c?b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.success"):(b("BanzaiODS").bumpEntityKey(2966,"ChannelTransport","sendPull.error"),j(h));return f&&f.apply(this,arguments)};h.send();a.inStreaming=a.streamingCapable;return h}function q(a){this.manager=a,this.init&&this.init()}function d(a){q.apply(this,arguments)}Object.assign(d.prototype,{logName:"CORS",enterState:function(a,c){this._request&&(this._request.abort(),this._request=null);a=="init"&&b("setTimeoutAcrossTransitions")(b("bind")(this.manager,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),0);if(!/pull|ping/.test(a))return;var d=this.manager;a=="ping"?this._request=o(c,b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=p(c,b("bind")(d,"_processTransportData",c.stateId),b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});function f(a){i.log("iframe_init_constructor"),q.apply(this,arguments),this._iframe=document.createElement("iframe"),this._iframe.style.display="none",document.body.appendChild(this._iframe),b("DocRPC").publish(this,"outerTransport")}Object.assign(f.prototype,{logName:"iframe",_initIframe:function(a){i.log("iframe_init_start");window.onchanneliframeready=function(){i.log("iframe_resources");return a.resources};window.onchanneliframeloaded=function(){i.log("iframe_loaded")};if(a){this._iframeURI=m(a,a.path);if(a.resources){var c=this._iframeURI.getDomain();a.resources=a.resources.map(function(a){var d=new(g||(g=b("URI")))(a);return d.getPath().startsWith("/intern/rsrc.php")&&d.getQueryData().origin!==void 0?d.addQueryData("origin",c).toString():a})}}else this._iframeURI="about:blank";this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI),i.log("iframe_uri_set")}catch(c){i.error("iframe_uri_set_error",c),this.exitState({status:b("ChannelConstants").ERROR,stateId:a.stateId},c+"")}},enterState:function(a,c){a=="init"?this._initIframe(c):/idle|ping|pull/.test(a)?this._iframeProxy?this._iframeProxy.enterState.apply(this._iframeProxy,arguments):a!="idle"&&this.exitState({status:b("ChannelConstants").ERROR,stateId:c.stateId},"iframe not yet loaded"):a=="shutdown"&&this._initIframe()},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments)},exitState:function(a){this.manager.state=="init"&&a.status==b("ChannelConstants").OK&&(this._iframeProxy=b("DocRPC").proxy(this._iframe.contentWindow,"innerTransport",["enterState"],(this._iframeURI+"").replace(/iframe.*/,"")));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments)}});function r(){this.init=this.init.bind(this),q.apply(this,arguments)}Object.assign(r.prototype,{logName:"iframe(inner)",init:function(){b("DocRPC").publish(this,"innerTransport");try{var a=b("DocRPC").proxy(window.parent,"outerTransport",["_processTransportData","exitState"],top.DocRPC.origin);Object.assign(this,a);this.exitState({status:b("ChannelConstants").OK,stateId:1e6})}catch(a){i.error("iframe_inner_init_error",a)}},enterState:function(a,c){this._request&&(this._request.abort(),this._request=null),a=="ping"?this._request=o(c,b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=p(c,b("bind")(this,"_processTransportData",c.stateId),b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});e.exports={isSubdomain:l,getURI:m,Transport:q,CORSTransport:d,IframeTransport:f,IframeInnerTransport:r,sendActivePing:c,sendAdditionalBuddyRequest:a}}),null);
__d("ChatProxyConnectionState",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.auxiliaryIrisQueues={},this.aiq=null}var b=a.prototype;b.subscribeIrisQueue=function(a,b){this.auxiliaryIrisQueues[a]=b,this.updateCaches()};b.unsubscribeIrisQueue=function(a){delete this.auxiliaryIrisQueues[a],this.updateCaches()};b.updateCaches=function(){var a=[];for(var b in this.auxiliaryIrisQueues)Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,b)&&(a.push(b),a.push(this.auxiliaryIrisQueues[b]));a.length===0?this.aiq=null:this.aiq=a.join(",")};return a}();e.exports=a}),null);
__d("FBAjaxRequest",["AjaxError","AjaxRequest","getAsyncParams"],(function(a,b,c,d,e,f){a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c,d,e){e=babelHelpers["extends"]({},b("getAsyncParams")(c),e);c=a.call(this,c,d,e)||this;c.$FBAjaxRequest1=e;c.streamMode=!1;return c}var d=c.prototype;d.onJSONSafe=function(){this.json&&(this.json.error&&(this.errorType=b("AjaxError").SERVER_ERROR,this.errorText="AsyncResponse error: "+this.json.error),this.json=this.json.payload),a.prototype.onJSONSafe.call(this)};d.send=function(b){a.prototype.send.call(this,babelHelpers["extends"]({},b,this.$FBAjaxRequest1))};return c}(b("AjaxRequest"));e.exports=a}),null);
__d("MovingStat",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a){this.$1=a>0?a:6e4,this.$2=0,this.$3=0,this.$5={t:new Date(),count:0,v:0},this.$4=this.$5}var b=a.prototype;b.add=function(a){this.$2+=a;this.$3++;var b=new Date();if(b-this.$5.t<1e3){this.$5.v+=a;this.$5.count++;return}this.$5.next={t:b,v:a,count:1};this.$5=this.$5.next;this.$6()};b.tally=function(a){a===void 0&&(a=1e3);this.$6();return{sum:this.$2,count:this.$3,timeAverage:this.$2*a/this.$1}};b.$6=function(){var a=new Date()-this.$1;while(this.$4&&this.$4.next&&this.$4.t<a)this.$2-=this.$4.v,this.$3-=this.$4.count,this.$4=this.$4.next};return a}();e.exports=a}),null);
__d("InstantGamesPresenceProperties",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=!1}var b=a.prototype;b.addInstantGamePresence=function(){this.$1=!0};b.removeInstantGamePresence=function(){this.$1=!1};b.isActiveGamePresence=function(){return this.$1};return a}();b=new a();e.exports=b}),null);
__d("PresenceProperties",["ChannelConstants","InstantGamesPresenceProperties","WorkplaceChatHelper"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){this.$1=b("ChannelConstants").CAPABILITY_VOIP_INTEROP}var c=a.prototype;c.getProperties=function(){b("WorkplaceChatHelper").isDesktopChatApp()&&(this.$1|=b("ChannelConstants").CAPABILITY_ACTIVE_ON_DESKTOP_APP);b("InstantGamesPresenceProperties").isActiveGamePresence()?this.$1|=b("ChannelConstants").CAPABILITY_PLAYING_INSTANT_GAME:this.$1&=~b("ChannelConstants").CAPABILITY_PLAYING_INSTANT_GAME;return this.$1};return a}();c=new a();e.exports=c}),null);
__d("RTISession",["invariant","AjaxRequest","BanzaiODS","ChatproxyClientErrorsTypedLogger","ErrorUtils","URI"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(){function a(a,b,c,d,e,f,g,h,i,j){this.domain=a,this.topLevelDomain=b,this.port=c,this.edgePoolName=d,this.stickyToken=e,this.loggedInId=f,this.accountId=g,this.clientProfile=h!=null?h:"desktop",this.clientId=i,this.capabilities=j}var c=a.prototype;c.issueRequest=function(a,c,d,e,f){var j=this,k=this.domain+"."+this.topLevelDomain,l=(1048576*Math.random()|0).toString(36);l={cb:l,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var m in l)c[m]&&g(0,1632);Object.assign(l,c);a=new(h||(h=b("URI")))(a).setDomain(k).setPort((c=this.port)!=null?c:"").setSecure(new h(window.location.href).isSecure()).setQueryData(l);k=d?"POST":"GET";var n=new(b("AjaxRequest"))(k,a);n.timeout=f!=null?f*1e3:3e4;n.streamMode=!1;n.xhr&&(n.xhr.withCredentials=!0);var o={};n.onSuccess=function(){b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.success")};n.onJSON=function(){o.data=n.json,o.error=null,(i||(i=b("ErrorUtils"))).applyWithGuard(e,j,[o])};n.onError=function(){var a=new Set(),c=null;if(d.subscriptions!=null&&Array.isArray(d.subscriptions)){c=d.subscriptions.length;for(var f=0;f<d.subscriptions.length;f++){var g=d.subscriptions[f].topic.split("/");g.pop();a.add(g.join("/"))}}o.data=null;o.error=n.errorType||"error";b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.error");j.$1(n,a,c);(i||(i=b("ErrorUtils"))).applyWithGuard(e,j,[o])};n.send(JSON.stringify(d));b("BanzaiODS").bumpEntityKey(2966,"RTISession","request.attempt")};c.$1=function(a,c,d){var e=new(b("ChatproxyClientErrorsTypedLogger"))();e.setStatusCode(a.status);if(a.xhr!=null){var f=a.xhr.getResponseHeader("x-fb-chat-failure-reason");f&&e.setErrorReason(f)}e.setSubscriberID(this.loggedInId);e.setSessionIDStr(this.clientId);e.setErrorMessage(a.errorType);e.setErrorText(a.errorText);e.setTopicPrefixes(c);e.setJsEventTimeMs(Math.floor(Date.now()/1e3));d!=null&&e.setBatchSize(d);a.uri&&e.setURL(a.uri.getPath());e.log()};return a}();e.exports=a}),null);
__d("ChannelManager",["errorCode","Promise","requireCond","AjaxError","AjaxRequest","Arbiter","AsyncRequest","BanzaiODS","ChannelClientID","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChatProxyConnectionState","ChatReliabilityInstrumentation","ChatVisibility","DesktopWebMessageTypesSitevarConfig","DTSG","Env","FantailLogger","FBAjaxRequest","FBMqttChannel","ISB","JSLogger","LogHistory","MovingStat","PresenceCookieManager","PresenceProperties","cr:1167612","PresenceUtil","Random","RTISession","SystemEvents","URI","UserActivity","clearTimeout","emptyFunction","requestAnimationFrameAcrossTransitions","setIntervalAcrossTransitions","setTimeoutAcrossTransitions","gkx"],(function(a,b,c,d,e,f,g){var h,i,j=b("JSLogger").create("channel"),k=b("LogHistory").getInstance("channel_manager"),l=b("gkx")("1175809"),m=b("gkx")("1234252"),n=b("gkx")("1271437"),o=null,p=b("emptyFunction"),q=new(b("Promise"))(function(a,b){p=a});function a(a){o=a}var r={idle:{ok:"init!"},init:{ok:"pull!",error:"reconnect",sys_online:"init",sys_timetravel:"init"},pull:{ok:"pull!",error:"ping",error_missing:"pull",error_msg_type:"pull",refresh_0:"reconnect",refresh_110:"reconnect",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},ping:{ok:"pull!",error:"ping",error_stale:"reconnect!"},reconnect:{ok:"init!",error:"reconnect",sys_online:"reconnect",sys_timetravel:"reconnect"},shutdown:{},_all:{error_max:"shutdown!",error_shutdown:"shutdown!",sys_owner:"reconnect",sys_nonowner:"idle!",sys_online:"ping",sys_offline:"idle!",sys_timetravel:"ping"}},s={state:new(b("ChatProxyConnectionState"))(),userActive:Date.now(),created:Date.now(),ready:!1,seqTurSentAt:-1,queueMade:"",sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,pws:"fresh",estimatedReceived:0,sessionID:b("ChannelClientID").getID(),capabilities:b("PresenceProperties").getProperties(),streamingCapable:!1,inStreaming:!1,shouldSuppressPresence:b("cr:1167612")?b("cr:1167612").shouldSuppress():!1,LONGPOLL_TIMEOUT:6e4,STREAMING_TIMEOUT:6e4,P_TIMEOUT:3e4,IFRAME_LOAD_TIMEOUT:3e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:32e4,MIN_12002_TIMEOUT:9e3,MIN_504_TIMEOUT:2e4,STALL_THRESHOLD:18e4,JUMPSTART_THRESHOLD:9e4,MIN_INIT_PROBE_DELAY:3e3,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12e3,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:1e4,PROBE_DELAY:6e4,PROBE_HEARTBEATS_INTERVAL_LOW:1e3,PROBE_HEARTBEATS_INTERVAL_HIGH:5e3,STREAMING_EXIT_STATE_ON_CONTINUE:!1},t=1,u={},v=0;function w(){var a=b("AsyncRequest").lastSuccessTime;return a?Math.round((Date.now()-a)/1e3):-1}function x(a,b){return Object.prototype.hasOwnProperty.call(s,a)?s[a]:b}function y(){var a={};x("host")&&(a[x("user_channel")]=x("seq",0));return a}function z(a){a?(v=0,u={}):v++}c={state:"idle",nextState:null,proxyDown:!1,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:a,backoff:!1,sessionRegistered:!1,_initTimer:null,_deferredTransition:null,_transportRate:null,_shutdownHint:null,init:function(a,c){var d=this;b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"initializing sessionid:%s at iris-seq:%s",s.sessionID,s.sequenceId);this.init=b("emptyFunction");b("Arbiter").subscribe(b("ChannelConstants").GET_RTI_SESSION_REQUEST,function(a,b){d.informCurrentSession()});b("Arbiter").subscribe(b("ChannelConstants").CONSOLE_LOG,function(a,b){});b("requestAnimationFrameAcrossTransitions")(function(){b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"using session id: %s at seq: %s {%s} with sticky: %s/%s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool),b("UserActivity").subscribe(function(){var a=b("ChannelTransport").getURI(s,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"user activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,d.state,a);d.state=="pull"&&(s.userActive=Date.now(),b("ChannelTransport").sendActivePing(s))}),b("Arbiter").subscribe(b("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING,function(a){a=b("ChannelTransport").getURI(s,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entity presence activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,d.state,a);d.state=="pull"&&(s.userActive=Date.now())})});b("PresenceCookieManager").register("ch",y);var e=this.getConfig("max_conn",2);s.subdomain=b("ChannelSubdomain").allocate(e);b("ChannelTransport").isSubdomain(s.subdomain)||(b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"invalid subdomain from ChannelSubdomain: %s",s.subdomain),s.subdomain=null);this._transportRate=new(b("MovingStat"))(3e4);var f=b("AjaxRequest").supportsCORS()?"CORSTransport":"IframeTransport";b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","transport_chosen."+f);this.transport=new(b("ChannelTransport")[f])(this);p(this.transport);a&&this.enterState(a,c);b("requestAnimationFrameAcrossTransitions")(function(){b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){d._transportRate&&(b.transportRate=d._transportRate.tally(),b.transportType=f,b.transportVersion=2)}),d._initMonitors()});if(this.getConfig("fullHost")&&b("AjaxRequest").supportsCORS()){if(this.getConfig("tryStreaming")){e=s.MIN_INIT_PROBE_DELAY+b("Random").random()*s.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._probeTest,e)}if(this.getConfig("trySSEStreaming")){a=s.MIN_INIT_PROBE_DELAY+b("Random").random()*s.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._sseProbeTest,a)}}},_mqttInit:function(){var a=this;b("FBMqttChannel").subscribe("/legacy_web",function(c){try{c=JSON.parse(c);a._processMqttMessage(c)}catch(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","mqttInit."+a.message)}})},configure:function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];k.log("configure",JSON.stringify(c));c.forEach(function(a){return Object.assign(s,a)});this._indicateLbInfoUpdated("reconnect",JSON.stringify(c));b("Arbiter").inform(b("ChannelConstants").ON_CONFIG,this)},getConfig:function(a,b){return x(a,b)},getCompleteConfig:function(){return s},subscribeIrisQueue:function(a,c){s.state.subscribeIrisQueue(a,c),this.exitState({status:b("ChannelConstants").OK,stateId:t})},unsubscribeIrisQueue:function(a){s.state.unsubscribeIrisQueue(a)},informCurrentSession:function(){var a=null;this.sessionRegistered&&s&&s.fullHost&&s.sticky_token&&s.uid&&(a=new(b("RTISession"))(s.fullHost,s.domain,s.port,s.sticky_pool,s.sticky_token,s.uid,s.viewerUid,s.profile,s.sessionID,s.capabilities));b("Arbiter").inform(b("ChannelConstants").RTI_SESSION,a)},isShutdown:function(){return this.state=="shutdown"},shouldIdle:function(){return!(b("SystemEvents").isPageOwner()&&b("SystemEvents").isOnline())},_sendIframeError:function(a){a=new(b("AsyncRequest"))().setURI("/ajax/presence/reconnect.php").setData({reason:a,fb_dtsg:b("DTSG").getToken()}).setOption("suppressErrorHandlerWarning",!0).setOption("retries",1).setMethod("GET").setReadOnly(!0).setAllowCrossPageTransition(!0);a.specifiesWriteRequiredParams()&&a.send()},_getDelay:function(){var a=Math.min(s.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,v-1)),s.MAX_RETRY_INTERVAL);this.proxyDown&&"proxy_down_delay_millis"in s&&(a=s.proxy_down_delay_millis);this.proxyDown=!1;return Math.floor(a*(1+Math.random()*.5))},resetDelay:function(){z(!0)},enterState:function(a,c){this._inEnterState&&(k.warn("enterstate_recursion",JSON.stringify({state:this.state,args:arguments})),b("ChatReliabilityInstrumentation").logERROR("enterstate_recursion"));this._inEnterState=!0;try{this._enterState.apply(this,arguments),this._inEnterState=!1}catch(a){this._inEnterState=!1;throw a}},_enterState:function(a){var c=this;if(n&&!(/init/.test(a)||/reconnect/.test(a)))return;var d=this.backoff?this._getDelay():0;this.backoff=!1;if(this.isShutdown()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"not executing state due to shutdown mode: %s",a);return}if(a!="idle!"&&this.shouldIdle()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"forced idleness");return}t++;s.stateId=t;b("clearTimeout")(this._deferredTransition);this._deferredTransition=null;!this.transport?(q.then(function(a){return a.enterState("idle")}),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState("idle");this.state="idle";this.nextState=null;if(/!$/.test(a)){if(this._transportRate){var e=this._transportRate.tally().timeAverage,f=this.getConfig("MAX_CHANNEL_STATES_PER_SEC",1);e>=f&&(this._throttled||(this._throttled=!0,k.warn("throttled","{}"),b("Arbiter").inform(b("ChannelConstants").THROTTLED,e)),j.bump("throttle"),d=1e3/f)}}else/#$/.test(a)||(d=this._getDelay());a=a.replace(/\W*$/,"");if(!r[a]){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"invalid state: %s",a);throw new Error("invalid state:"+a)}var g=Array.from(arguments),h={};if(d<=0){h.state=a;this._transportRate&&this._transportRate.add(1);this.state=a;var i=this["_enter_"+this.state];i&&(g.shift(),i.apply(this,g));/init|idle|pull|ping/.test(this.state)&&(s.streamingCapable&&/pull/.test(this.state)&&(this.heartbeats=[]),s.is_offline=!b("ChatVisibility").isOnline(),s.capabilities=b("PresenceProperties").getProperties(),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entering transport state: %s",this.state),!this.transport?(q.then(function(a){return a.enterState(c.state,s)}),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState(this.state,s),this.state=="ping"&&(h.url=b("ChannelTransport").getURI(s).toString(),h.port=s.port||"undefined"))}else this.state="idle",this.nextState=a,h.state=this.state,h.delay=d,h.nextState=a,g[0]=a+"#",this._deferredTransition=b("setTimeoutAcrossTransitions")(function(){c._deferredTransition=null,c.enterState.apply(c,g)},d);/pull/.test(a)&&(h.client_id=s.sessionID,h.streaming=s.inStreaming);b("Arbiter").inform(b("ChannelConstants").ON_ENTER_STATE,h)},exitState:function(a,c){var d=a.stateId,e=a.status;if(this.isShutdown()||d<t)return;var f=this.state,g=Array.from(arguments);g[0]=a.status;var h={};h.state=f;h.status=e;/pull/.test(f)&&(h.client_id=s.sessionID,h.streaming=s.inStreaming);/ping/.test(f)&&e!=b("ChannelConstants").OK&&(h.url=b("ChannelTransport").getURI(s).toString());this.nextState&&(h.nextState=this.nextState);c&&c.errorType?(s.lastRequestErrorReason=c.errorType,h.xhr=c.toJSON?c.toJSON():c,c.errorType==b("AjaxError").SERVICE_UNAVAILABLE&&(b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got 5xx http status code, setting long delay"),this.proxyDown=!0),delete h.xhr.json):e!=b("ChannelConstants").OK&&(s.lastRequestErrorReason=e);c&&c.json&&(c.json.t&&(h.t=c.json.t),c.json.reason&&(h.reason=c.json.reason),c.json.seq&&(h.seq=c.json.seq));b("Arbiter").inform(b("ChannelConstants").ON_EXIT_STATE,h);var i=this["_exit_"+f];i&&(e=i.apply(this,g)||e);e!=b("ChannelConstants").OK&&(z(),u[f]=(u[f]||0)+1);var j=r[this.nextState||f][e]||r._all[e],l=j&&j.replace(/!*$/,"");l||(k.error("terminal_transition",JSON.stringify(h)),this._shutdownHint=b("ChannelConstants").HINT_INVALID_STATE,j="shutdown!",b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"entering shutdown state"));this._lastState=f;this._lastStatus=e;this.enterState(j)},_processTransportData:function(a,b){this._processTransportData0(a,b,b.json)},_processTransportData0:function(a,c,d){var e=d.t;"s"in d&&(d.seq=d.s,delete d.s);if(d.u&&s.user&&d.u!=s.user){k.warn("misguided_msg",JSON.stringify({user:s.user,target:d.u}));this._reportProxyMisguidedMsg(d.u,s.user);return}var f=s.seq;"seq"in d&&(s.seq=d.seq,b("cr:1167612")&&b("cr:1167612").doSync());switch(e){case"continue":s.inStreaming&&this.heartbeats.length<1&&(s.streamingCapable=!1,k.log("switch_to_longpoll","{}"),b("setTimeoutAcrossTransitions")(this._probeTest,s.PROBE_DELAY));z(!0);(!s.inStreaming||s.STREAMING_EXIT_STATE_ON_CONTINUE)&&this.exitState({status:b("ChannelConstants").OK,stateId:a});break;case"refresh":case"refreshDelay":b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"got refresh with reason: %s",d.reason);this.exitState({status:"refresh_"+(d.reason||0),stateId:a},c);break;case"backoff":b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"server told client to back off");z();this.backoff=!0;break;case"lb":var g=d.lb_info;if(g){s.sticky_token=g.sticky;"pool"in g&&(s.sticky_pool=g.pool);if("sd"in g){var h=g.subdomain;b("ChannelTransport").isSubdomain(h)&&(s.subdomain=g.subdomain)}"vip"in g&&(s.host=g.vip);this._indicateLbInfoUpdated("chatproxy",JSON.stringify(d))}else k.error("missing_lb_info","{}");break;case"test_streaming":b("setTimeoutAcrossTransitions")(this._probeTest,500);break;case"fullReload":b("PresenceCookieManager").clear();k.log("full_reload","{}");this.sessionRegistered=!0;this.informCurrentSession();b("Arbiter").inform(b("ChannelConstants").ON_INVALID_HISTORY);z(!0);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"full reload incurred");h=b("ChannelConstants").OK;this.exitState({status:h,stateId:a},c);"ms"in d&&this._processMessages(d,f);break;case"msg":z(!0);this._processMessages(d,f);break;case"heartbeat":if(s.inStreaming){g=Date.now();var i;this.heartbeats.length>0&&(i=g-this.heartbeats[this.heartbeats.length-1]);k.log("heartbeat_interval",JSON.stringify({client_id:s.sessionID,interval:i}));this.heartbeats.push(g)}break;case"batched":h=d.batches;for(var f=0;f<h.length;f++)this._processTransportData0(a,c,h[f]);break;default:b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got an unknown protocol message: %s",e);k.error("unknown_msg_type",JSON.stringify({type:e}));break}},_processMqttMessage:function(a){if(b("DesktopWebMessageTypesSitevarConfig").ChatProxySupportedMessageTypes.get(a.type)===!0&&b("DesktopWebMessageTypesSitevarConfig").MQTTMigrationExcludeMessageTypes.get(a.type)!==!0)if(a.type==="rtc_live_json"&&!l)b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages.dropped."+a.type);else{var c=b("ChannelConstants").getArbiterType(a.type);b("Arbiter").inform(c,{obj:a});b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages."+a.type)}else b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMqttMessages.dropped."+a.type)},_processMessages:function(a,c){"tr"in a&&(s.trace_id=a.tr);a=a.ms;var d=s.seq-a.length;for(var e=0;e<a.length;e++,d++){s.estimatedReceived++;if(d>=c){var f=a[e];if(f.type){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","messageReceive."+f.type);if(b("DesktopWebMessageTypesSitevarConfig").ChatProxySupportedMessageTypes.get(f.type)!==!0){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.dropped."+f.type);continue}var g=b("ChannelConstants").getArbiterType(f.type);f.type==="skywalker"?g=b("ChannelConstants").SKYWALKER:f.type==="qprimer"?m||(f.first=!s.ready,f.first&&(s.ready=!0,s.timeUntilReady=Date.now()-s.created,s.queueMade=f.made),g=b("ChannelConstants").CHANNEL_ESTABLISHED):f.type==="delta"&&(s.sequenceId=f.iseq);try{f.type=="buddylist_overlay"&&f.buffered==1?b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.buddylist_overlay.dropped"):b("DesktopWebMessageTypesSitevarConfig").MQTTMigrationExcludeMessageTypes.get(f.type)!==!0?f.type==="rtc_live_json"&&!l?b("Arbiter").inform(g,{obj:f}):b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.migration.list."+f.type):b("Arbiter").inform(g,{obj:f})}catch(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","processMessages.error."+f.type),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"message threw exception: %s %s",a,f)}}}else k.warn("seq_regression",JSON.stringify({last_seq:c,messages:a.length,seq:d}))}},_enter_init:function(){var a=this;if(u.init>=this.getConfig("MAX_INIT_FAILS",2))return b("setTimeoutAcrossTransitions")(function(){return a.exitState({status:b("ChannelConstants").ERROR_MAX,stateId:t})},0);this._initTimer=b("setTimeoutAcrossTransitions")(function(){return a.exitState({status:b("ChannelConstants").ERROR,stateId:t},"timeout")},s.IFRAME_LOAD_TIMEOUT)},_enter_reconnect:function(a){var c=this;k.warn("enter_reconnect",a);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entered reconnect with reason: %s",a);var d=t;if(!b("PresenceUtil").hasUserCookie()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"user has no cookie???");k.warn("no_user_cookie","{}");b("setTimeoutAcrossTransitions")(function(){c._shutdownHint=b("ChannelConstants").HINT_AUTH,c.exitState({status:b("ChannelConstants").ERROR_SHUTDOWN,stateId:d})},0);return}var e={};e.reason=a;e.fb_dtsg=b("DTSG").getToken();b("ISB").token&&(e.fb_isb=b("ISB").token);o&&o(e);var f=new(b("FBAjaxRequest"))("GET","/ajax/presence/reconnect.php",e);f.onSuccess=function(){c.configure(f.json),b("PresenceCookieManager").store(),c.exitState({status:b("ChannelConstants").OK,stateId:d})};f.onError=function(){var a=f.json&&f.json.error;b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"reconnect error: %s",f.errorType);(f.errorType==b("AjaxError").TRANSPORT_ERROR||f.errorType==b("AjaxError").PROXY_ERROR||f.errorType==b("AjaxError").SERVICE_UNAVAILABLE)&&(c._shutdownHint=b("ChannelConstants").HINT_CONN);a&&a==1356007?c._shutdownHint=b("ChannelConstants").HINT_MAINT:a==1357001||a==1357004||a==1348009?c._shutdownHint=b("ChannelConstants").HINT_AUTH:c._shutdownHint=null;c.exitState({status:c._shutdownHint?b("ChannelConstants").ERROR_SHUTDOWN:b("ChannelConstants").ERROR,stateId:d},f)};!n?f.send():f.onSuccess()},_enter_shutdown:function(){var a=this;b("Arbiter").inform(b("ChannelConstants").ON_SHUTDOWN,{reason:this._shutdownHint});if("shutdown_recovery_interval_seconds"in s&&s.shutdown_recovery_interval_seconds>0){var c=s.shutdown_recovery_interval_seconds*1e3;b("setTimeoutAcrossTransitions")(function(){b("Arbiter").inform(b("ChannelConstants").ATTEMPT_RECONNECT),a._shutdownHint=null,a.state="reconnect!",a.enterState("reconnect!")},c)}},_exit_init:function(a){this._initTimer&&(this._initTimer=b("clearTimeout")(this._initTimer)),a==b("ChannelConstants").ERROR_MAX&&this._sendIframeError(b("ChannelConstants").reason_IFrameLoadGiveUp)},_exit_pull:function(a,c){if(a===b("ChannelConstants").OK){this.lastPullTime=Date.now();return}a="exit status: "+a;c&&c.errorType&&(a+=" ajax request error: "+c.errorType);b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"pull failed with status: %s",a)},_exit_ping:function(a){if(a!==b("ChannelConstants").OK){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"ping failed with status: %s",a);return}a=Date.now()-(this.lastPullTime||(h||(h=b("Env"))).start);if(a>s.STALL_THRESHOLD){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"didnt complete a successful pull for too long");return b("ChannelConstants").ERROR_STALE}},_reportProxyMisguidedMsg:function(a,c){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"misguided message to %s meant for %s",c,a);var d=Date.now();if(d-this.lastReportOnMisguidedMsgTime<=s.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=d;d={};d.received_uid=a;d.expected_uid=c;s.sticky_token&&(d.sticky_token=s.sticky_token);a=new(i||(i=b("URI")))("/err_misguided_msg").setDomain(s.host+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(d);c=new(b("AjaxRequest"))("GET",a);b("AjaxRequest").supportsCORS()&&(c.xhr.withCredentials=!0);c.onSuccess=function(a){};c.onError=function(a){};c.onJSON=function(a){};c.send()},_initMonitors:function(){var a=this,c,d=Date.now(),e=Date.now(),f={};f.total=0;var g="idle",i=!1;(c=b("SystemEvents")).subscribe([c.USER,c.ONLINE,c.TIME_TRAVEL],function(c,d){z(!0);e=null;a.lastPullTime=Date.now();var f;switch(c){case b("SystemEvents").USER:f=b("SystemEvents").isPageOwner()?b("ChannelConstants").SYS_OWNER:b("ChannelConstants").SYS_NONOWNER;break;case b("SystemEvents").ONLINE:f=d?b("ChannelConstants").SYS_ONLINE:b("ChannelConstants").SYS_OFFLINE;break;case b("SystemEvents").TIME_TRAVEL:if(s.skipTimeTravel)return;if(0<d){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"skipping time travel failure. %s",d);return}f=b("ChannelConstants").SYS_TIMETRAVEL;break}a.exitState({status:f,stateId:t})});c=function(a,c){var h=Date.now(),i=null;c?(d=h,i=c.nextState||c.state):i=g;b("SystemEvents").checkTimeTravel();if(e){c=Math.round((h-e)/1e3);c>0&&(f[g]=(f[g]||0)+c,f.total+=c)}g=i;e=h;a||(f.lastSuccessTime=w(),f.online=b("SystemEvents").isOnline(),k.log("rollup",JSON.stringify(f)))};b("Arbiter").subscribe(b("ChannelConstants").ON_ENTER_STATE,c);b("setIntervalAcrossTransitions")(c,6e4);b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.channelRollup=f});c=function(){if(a.isShutdown()||a.shouldIdle())return;b("SystemEvents").checkTimeTravel();var c=Date.now()-(a.lastPullTime||(h||(h=b("Env"))).start);if(!i&&c>s.STALL_THRESHOLD){var e=w();k.error("stall",JSON.stringify({lastSuccessTime:e,rollupState:g}));b("ChatReliabilityInstrumentation").logCHANNEL_STALLED(c.toString());i=!0}e=Date.now()-(d||0);a.state=="pull"&&e>s.JUMPSTART_THRESHOLD&&(d=null,k.warn("jumpstart",JSON.stringify({state:a.state,dormant:e})),b("Arbiter").inform(b("ChannelConstants").JUMPSTART,e),a.enterState("init"))};b("setIntervalAcrossTransitions")(c,5e3)},_indicateLbInfoUpdated:function(a,c){var d=!b("AjaxRequest").supportsCORS(),e=b("ChannelTransport").isSubdomain(s.subdomain);!e||d?s.fullHost=s.host:s.fullHost=s.subdomain+"-"+s.host;b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"received lb info: %s at seq: %s{%s} with ".concat("sticky: %s/%s, subdomain: %s, fullHost: %s, state: %s,").concat(" source: %s, args: %s"),s.sessionID,s.seq,s.sequenceId,s.sticky_token,s.sticky_pool,s.subdomain,s.fullHost,this.state,a,c)},_probeTest:function(){s.streamingCapable=!1;var a=[],c={};c.mode="stream";c.format="json";s.sticky_token&&(c.sticky_token=s.sticky_token);c=new(i||(i=b("URI")))("/probe").setDomain(s.fullHost+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.attempt");c=new(b("AjaxRequest"))("GET",c);c.onJSON=function(c,d){if(c&&c.json&&c.json.t==="heartbeat"){a.push(Date.now());if(a.length>=2){d=a[1]-a[0];d>=s.PROBE_HEARTBEATS_INTERVAL_LOW&&d<=s.PROBE_HEARTBEATS_INTERVAL_HIGH?(s.streamingCapable=!0,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.switch_to_streaming"),k.log("switch_to_streaming","{}")):b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.delayed")}}};c.onSuccess=function(c){a.length!=2&&(s.streamingCapable=!1,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.data_loss"),k.error("probe_error",JSON.stringify({error:"beats.length = "+a.length}))),b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.success"),k.log("probe_success","{}")};c.onError=function(a){s.streamingCapable=!1,b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","probe.failure.error"),k.error("probe_error",JSON.stringify(a))};c.send()},_sseProbeTest:function(){if(!window.EventSource){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.no_event_source");k.log("sse_probe.failure.no_event_source","{}");return}var a=[],c={};c.mode="sse";c.format="json";s.sticky_token&&(c.sticky_token=s.sticky_token);c=new(i||(i=b("URI")))("/sse_probe").setDomain(s.fullHost+"."+s.domain).setPort(s.port).setSecure(new i(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.attempt");var d=new EventSource(c.toString()),e=b("setTimeoutAcrossTransitions")(function(){d.close(),b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.timeout"),k.log("sse_probe.failure.timeout","{}")},s.PROBE_HEARTBEATS_INTERVAL_HIGH*6);d.addEventListener("heartbeat",function(c){a.push(Date.now());if(a.length>=2){c=a[1]-a[0];c>=s.PROBE_HEARTBEATS_INTERVAL_LOW&&c<=s.PROBE_HEARTBEATS_INTERVAL_HIGH?(b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.success"),k.log("sse_probe.success","{}")):(b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.delayed"),k.log("sse_probe.failure.delayed","{}"));b("clearTimeout")(e);d.close()}});d.onerror=function(a){b("BanzaiODS").bumpEntityKey(2966,"ChannelManager","sse_probe.failure.error"),k.error("sse_probe.failure.error",JSON.stringify(a)),b("clearTimeout")(e),d.close()}},startChannelManagerForApp:function(a){this.startChannelManager!==b("emptyFunction")&&this.startChannelManager(),b("ChannelInitialData").channelConfig&&s&&(s.profile=a)},startChannelManager:function(){b("ChannelInitialData").channelConfig?(this.configure(b("ChannelInitialData").channelConfig),/shutdown/.test(b("ChannelInitialData").state)&&(this._shutdownHint=b("ChannelConstants")[b("ChannelInitialData").reason]),this.init(b("ChannelInitialData").state,b("ChannelInitialData").reason),this._mqttInit(),b("ChatReliabilityInstrumentation").logCHANNEL_INIT(),this.startChannelManager=b("emptyFunction")):b("ChatReliabilityInstrumentation").logCHANNEL_NOCONFIG()}};e.exports=c}),null);
__d("LiveMapEntryPointsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:LiveMapEntryPointsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:LiveMapEntryPointsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:LiveMapEntryPointsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setEntryPoint=function(a){this.$1.entry_point=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setViewerCount=function(a){this.$1.viewer_count=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={entry_point:!0,event:!0,time:!0,vc:!0,viewer_count:!0,weight:!0};e.exports=a}),null);
__d("LiveMapEntryPointsLoggerController",["LiveMapEntryPointsTypedLogger"],(function(a,b,c,d,e,f){"use strict";a={logEndscreenImpression:function(){new(b("LiveMapEntryPointsTypedLogger"))().setEvent("impression").setEntryPoint("endscreen").log()}};e.exports=a}),null);
__d("XGamesVideoHomeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/gaming/{?vanity}/",{view:{type:"Enum",enumType:1},game_id:{type:"FBID"},section_id:{type:"String"},previous_view:{type:"Enum",enumType:1},sub_view:{type:"Enum",enumType:1},external_ref:{type:"Enum",defaultValue:"unknown",enumType:1},hc_ref:{type:"String"},streamer_vanity:{type:"String"},vanity:{type:"String"},video_id:{type:"String"},follow:{type:"Bool",defaultValue:!1},go_live:{type:"Bool",defaultValue:!1}})}),null);
__d("XLiveURLDelegationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/",{rest:{type:"String"},ref:{type:"Enum",enumType:1},v:{type:"FBID"}})}),null);
__d("VideoComponentLiveEndScreen.react",["cx","fbt","CenteredContainer.react","Link.react","LiveMapEntryPointsLoggerController","React","RelayModern","RoundImage.react","SubscriptionsHandler","VideoComponent","XGamesVideoHomeController","XLiveURLDelegationController","cxMargin","joinClasses","VideoComponentLiveEndScreenQuery.graphql"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("React");b("RelayModern").graphql;var k=70;a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c)||this;d.$1=function(){d.$2()&&b("LiveMapEntryPointsLoggerController").logEndscreenImpression()};d.vpc=null;d.subscriptions=new(b("SubscriptionsHandler"))();return d}var d=c.prototype;d.enable=function(a){this.vpc=a,this.subscriptions.engage(),this.subscriptions.addSubscriptions(a.addListener("finishPlayback",this.$1)),a.registerOption("VideoLiveEndscreen","enabled",function(){return!0})};d.disable=function(){this.subscriptions.release()};d.render=function(){var a=this.props,c=this.vpc;return!a.video||!c||c.getState()!=="finished"||!this.props.videoData.isLiveStream()?null:j.jsxs("div",{className:b("joinClasses")(this.props.className,"_1uwa"),children:[j.jsx("div",{className:"_5sjs"}),j.jsx(b("CenteredContainer.react"),{vertical:!0,className:"_2q2t",children:j.jsx("div",{className:"_1uwb",children:j.jsx("div",{className:"_39rw",children:this.$3(this.props.video)})})})]})};d.$3=function(a){var c=a.liveEndText,d=a.liveEndFollowPromptText,e=a.owner;a=a.isLiveAudioFormat;e=j.jsx(b("RoundImage.react"),{className:"_3-96",src:e.profilePicture.uri,width:k,height:k});var f=h._("This live video has ended."),g=h._("This live audio has ended.");a=a?g:f;g=this.$4()?null:j.jsxs("div",{children:[j.jsxs("div",{children:[c?c.text:"",j.jsx("div",{children:d?d.text:""})]}),this.$5()]});f=j.jsxs("div",{className:"_39ry",children:[e,j.jsx("div",{className:"_39rz",children:a}),g]});return f};d.$5=function(){if(this.$2())if(this.$6()){var a=b("XGamesVideoHomeController").getURIBuilder().getURI();return j.jsx("div",{className:"_2pig",children:j.jsx(b("Link.react"),{href:a,className:"_39g5",children:j.jsx("div",{className:"_1svp",children:h._("See more gaming streams")})})})}else{a=b("XLiveURLDelegationController").getURIBuilder().setEnum("ref","trending").getURI();return j.jsx("div",{className:"_2pig",children:j.jsx(b("Link.react"),{href:a,className:"_39g5",children:j.jsx("div",{className:"_1svp",children:h._("Explore more live videos.")})})})}return null};d.$2=function(){return!1};d.$6=function(){return!!this.props&&!!this.props.videoData&&this.props.videoData.getContentCategory()==="gaming"};d.$4=function(){return!!this.vpc&&this.vpc.getPlayerOrigin()==="fb_stories"};return c}(j.Component);e.exports=b("VideoComponent").createContainer(a,{suppressMount:function(a){return a.getStreamType()==="progressive"},observedVpcEvents:["beginPlayback","finishPlayback","playRequested"],videoGraphQLQuery:i!==void 0?i:i=b("VideoComponentLiveEndScreenQuery.graphql")})}),null);
__d("VideoComponentLiveInterruptedScreen.react",["cx","fbt","CenteredContainer.react","ChannelManager","React","RelayModern","VideoComponent","joinClasses","VideoComponentLiveInterruptedScreenQuery.graphql"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("React");b("RelayModern").graphql;b("ChannelManager").startChannelManager();a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.vpc=null;return b}var d=c.prototype;d.enable=function(a){this.vpc=a};d.disable=function(){};d.render=function(){return!this.vpc||!this.vpc.isStreamInterrupted()?null:j.jsxs("div",{className:b("joinClasses")(this.props.className,"_1uwa _3htz"),children:[j.jsx("div",{className:"_4qn1"}),j.jsx(b("CenteredContainer.react"),{vertical:!0,className:"_2q2t",children:j.jsx("div",{className:"_1uwb",children:j.jsx("div",{className:"_39rw",children:this.$1()})})})]})};d.$1=function(){var a=h._("Live video interrupted"),b=h._("Live audio interrupted"),c=this.props.video&&this.props.video.isLiveAudioFormat;c=c?b:a;return j.jsxs("div",{className:"_39ry",children:[j.jsx("div",{className:"_39rz",children:c}),j.jsx("div",{className:"_4qn3",children:h._("The broadcast has been paused. It should resume shortly.")})]})};return c}(j.Component);e.exports=b("VideoComponent").createContainer(a,{suppressMount:function(a){return a.getStreamType()==="progressive"},observedVpcEvents:["streamInterrupted","streamResumed"],videoGraphQLQuery:i!==void 0?i:i=b("VideoComponentLiveInterruptedScreenQuery.graphql")})}),null);