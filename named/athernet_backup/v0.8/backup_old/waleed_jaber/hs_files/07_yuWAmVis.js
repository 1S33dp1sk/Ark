if (self.CavalryLogger) { CavalryLogger.start_js(["xsjWl"]); }

__d("SpotlightViewerBottomBar",["cx","LeftRight.react","React","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){"use strict";var a=Array.isArray(this.props.children)?this.props.children:[this.props.children],c="_4_8n _51an";this.props.className&&(c=b("joinClasses")(c,this.props.className));if(a.length===1)return b("React").createElement("div",{className:c},a[0]);c=b("joinClasses")(c,"_50-m");return b("React").createElement(b("LeftRight.react"),{className:c},a[0],a[1])};function a(){"use strict";h.apply(this,arguments)}e.exports=a}),null);
__d("SpotlightViewerBottomBarGroup",["cx","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props.itemmargin||"right";a=(a=="left"?"marginLeft":"")+(a=="right"?" marginRight":"")+" _4_8i";return b("React").createElement("div",{className:a},this.props.children)};function a(){"use strict";h.apply(this,arguments)}e.exports=a}),null);
__d("MessagingVideoViewer.react",["cx","fbt","ActorURI","ArbiterMixin","AsyncRequest","MessagingForwardingButtonNUX.react","PageTransitionsRegistrar","PhotoViewerDimensions","React","ReactFragment","SpotlightViewer","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewport","Vector","XMessagingVideoAttachmentController","guid"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("React").PropTypes;var i=200;c=b("React").createClass({displayName:"MessagingVideoViewer",propTypes:{disableForward:a.bool,forwardDialogComponent:a.func.isRequired,pageID:a.number,rootClassName:a.string,videoSize:a.instanceOf(b("Vector")).isRequired,videoID:a.string.isRequired,videoURI:a.string.isRequired},mixins:[b("ArbiterMixin")],getInitialState:function(){var a=new(b("PhotoViewerDimensions"))({verticalPadding:i});return{dimensions:a.getStageDimensions(this.props.videoSize),loading:!0,open:!0,showForward:!1}},UNSAFE_componentWillMount:function(){this._domID=b("guid")()},componentDidMount:function(){this._loadVideoPlayer(),b("PageTransitionsRegistrar").registerCompletionCallback(function(){this.close();return!0}.bind(this))},_loadVideoPlayer:function(){var a=b("XMessagingVideoAttachmentController").getURIBuilder().setString("video_id",this.props.videoID).setString("video_container_id",this._domID).setInt("width",this.state.dimensions.x).setInt("height",this.state.dimensions.y).getURI();this.props.pageID&&(a=b("ActorURI").create(a,this.props.pageID));this.request=new(b("AsyncRequest"))().setMethod("GET").setURI(a).setReadOnly(!0).setHandler(function(a){return this.setState({loading:!1})}.bind(this)).send()},close:function(){if(!this.state.open)return;this.setState({open:!1},function(){this.inform("close")})},_showForwardDialog:function(){this.setState({showForward:!0}),this.refs.forwardNUX.close()},_hideForwardDialog:function(){this.setState({showForward:!1})},renderLayers:function(){if(this.props.disableForward)return null;var a=h._("Forward in separate messages"),c=this.props.forwardDialogComponent;return b("ReactFragment").create({forwardDialog:b("React").createElement(c,{attachmentID:this.props.videoID,onClose:this._hideForwardDialog,shown:this.state.showForward,title:a}),forwardButtonNUX:b("React").createElement(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return this.refs.forwardButton}.bind(this),ref:"forwardNUX"},h._("Send this video to other people in separate messages."))})},render:function(){var a=b("React").createElement("div",{className:"rfloat",id:this._domID}),c;this.props.disableForward||(c=b("React").createElement(b("SpotlightViewerBottomBarLink"),{onClick:this._showForwardDialog,ref:"forwardButton"},h._("Forward")));return b("React").createElement("span",null,b("React").createElement(b("SpotlightViewer"),{onHide:this.close,open:this.state.open,rootClassName:this.props.rootClassName},b("React").createElement(b("SpotlightViewport"),{active:!0,className:"_39hc",media:a,showLoadingIndicator:this.state.loading,stageDimensions:this.state.dimensions,useWidth:!0},b("React").createElement(b("SpotlightViewerClose"),{onClick:this.close}),b("React").createElement(b("SpotlightViewerBottomBar"),{className:"stat_elem"},b("React").createElement(b("SpotlightViewerBottomBarGroup"),null),b("React").createElement(b("SpotlightViewerBottomBarGroup"),null,c,b("React").createElement(b("SpotlightViewerBottomBarLink"),{s:"true",href:this.props.videoURI},h._("Download")))))),this.renderLayers())}});e.exports=c}),null);
__d("SpotlightMessagesViewer",["fbt","ActorURI","ArbiterMixin","MessagingForwardingButtonNUX.react","PageTransitionsRegistrar","React","ReactFragment","SpotlightViewer","SpotlightViewerAutoResize","SpotlightViewerBehaviorsMixin","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerClose","SpotlightViewerCoreMixin","SpotlightViewerDimensionMixin","SpotlightViewerPagers","SpotlightViewerPageWithKeys","SpotlightViewerThumbnailMixin","SpotlightViewport","SubscriptionsHandler","XMessagingPhotoDownloadController"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").createClass({displayName:"SpotlightMessagesViewer",mixins:[b("ArbiterMixin"),b("SpotlightViewerBehaviorsMixin"),b("SpotlightViewerCoreMixin"),b("SpotlightViewerThumbnailMixin"),b("SpotlightViewerDimensionMixin")],behaviors:[b("SpotlightViewerPageWithKeys"),b("SpotlightViewerAutoResize")],componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release(),this._subscriptions=null},getViewerID:function(){return this.props.setid},getInitialState:function(){this._subscriptions=new(b("SubscriptionsHandler"))();return{photoData:this._getInitialPhotoData(),open:!0,showForward:!1}},_enableSubscriptions:function(){this.props.useloadingindicator&&this._subscriptions.addSubscriptions(this.viewState.subscribe("photo_fetch",function(){return this.setState({photoData:null})}.bind(this)))},_showForwardDialog:function(){this.setState({showForward:!0}),this.refs.forwardNUX.close()},_hideForwardDialog:function(){this.setState({showForward:!1})},renderLayers:function(){if(this.props.disableForward)return null;var a=g._("Forward in separate messages"),c=this.props.forwardDialogComponent;return b("ReactFragment").create({forwardDialog:b("React").createElement(c,{attachmentID:String(this.state.photoData.id),onClose:this._hideForwardDialog,shown:this.state.showForward,title:a}),forwardButtonNUX:b("React").createElement(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return this.refs.forwardButton}.bind(this),ref:"forwardNUX"},g._("Send this image to other people in separate messages."))})},render:function(){var a=this.getMedia(),c=this.props.snapToPhoto?this.getImageDimensions():this.getStageDimensions();c.x=Math.max(c.x,185);c.y=Math.max(c.y,185);var d=this.props.useloadingindicator&&!this.state.photoData;b("PageTransitionsRegistrar").registerCompletionCallback(function(){this.state.open&&this.close();return!0}.bind(this));return b("React").createElement("span",null,b("React").createElement(b("SpotlightViewer"),{rootClassName:this.props.rootClassName,open:this.state.open,onHide:this.close},b("React").createElement(b("SpotlightViewport"),{active:!1,onClick:this._onClickViewport,stageDimensions:c,media:a,showLoadingIndicator:d,useWidth:!0},b("React").createElement(b("SpotlightViewerClose"),{onClick:this.close}),this.props.disablepaging?null:b("React").createElement(b("SpotlightViewerPagers"),null),this._renderBottomBar())),this.renderLayers())},_renderBottomBar:function(){var a;this.props.disableForward||(a=b("React").createElement(b("SpotlightViewerBottomBarLink"),{onClick:this._showForwardDialog,ref:"forwardButton"},g._("Forward")));var c=b("XMessagingPhotoDownloadController").getURIBuilder().setString("photo_id",String(this.state.photoData.id)).getURI();this.props.actorid&&(c=b("ActorURI").create(c,this.props.actorid));return b("React").createElement(b("SpotlightViewerBottomBar"),null,b("React").createElement(b("SpotlightViewerBottomBarGroup"),null),b("React").createElement(b("SpotlightViewerBottomBarGroup"),null,a,b("React").createElement(b("SpotlightViewerBottomBarLink"),{rel:"async",ajaxify:c},g._("Download"))))}});e.exports=a}),null);